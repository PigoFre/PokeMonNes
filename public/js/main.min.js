!function t(e,s,r){function i(o,a){if(!s[o]){if(!e[o]){var P="function"==typeof require&&require;if(!a&&P)return P(o,!0);if(h)return h(o,!0);var R=new Error("Cannot find module '"+o+"'");throw R.code="MODULE_NOT_FOUND",R}var p=s[o]={exports:{}};e[o][0].call(p.exports,function(t){var s=e[o][1][t];return i(s?s:t)},p,p.exports,t,e,s,r)}return s[o].exports}for(var h="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(t,e,s){"use strict";var r=t("./NES");r.prototype.MapperProto=function(t){this.Core=t,this.MAPPER_REG=null},r.prototype.MapperProto.prototype.Init=function(){},r.prototype.MapperProto.prototype.ReadLow=function(t){return 64},r.prototype.MapperProto.prototype.WriteLow=function(t,e){},r.prototype.MapperProto.prototype.ReadPPUData=function(){return this.Core.ReadPPUData_SUB()},r.prototype.MapperProto.prototype.WritePPUData=function(t){this.Core.WritePPUData_SUB(t)},r.prototype.MapperProto.prototype.BuildBGLine=function(){this.Core.BuildBGLine_SUB()},r.prototype.MapperProto.prototype.BuildSpriteLine=function(){this.Core.BuildSpriteLine_SUB()},r.prototype.MapperProto.prototype.ReadSRAM=function(t){return this.Core.SRAM[8191&t]},r.prototype.MapperProto.prototype.WriteSRAM=function(t,e){this.Core.SRAM[8191&t]=e},r.prototype.MapperProto.prototype.Write=function(t,e){},r.prototype.MapperProto.prototype.HSync=function(t){},r.prototype.MapperProto.prototype.CPUSync=function(t){},r.prototype.MapperProto.prototype.SetIRQ=function(){this.Core.toIRQ|=4},r.prototype.MapperProto.prototype.ClearIRQ=function(){this.Core.toIRQ&=-5},r.prototype.MapperProto.prototype.OutEXSound=function(t){return t},r.prototype.MapperProto.prototype.EXSoundSync=function(t){},r.prototype.MapperProto.prototype.OutSRAM=function(){for(var t="",e=0;e<this.Core.SRAM.length;e++)t+=(this.Core.SRAM[e]<16?"0":"")+this.Core.SRAM[e].toString(16);return t.toUpperCase()},r.prototype.MapperProto.prototype.InSRAM=function(t){var e;for(e=0;e<this.Core.SRAM.length;e++)this.Core.SRAM[e]=0;try{for(e=0;e<2*this.Core.SRAM.length&&e<t.length;e+=2)this.Core.SRAM[e/2]=parseInt(t.substr(e,2),16)}catch(s){return!1}return!0},r.prototype.MapperProto.prototype.GetState=function(){null!==this.MAPPER_REG&&(this.Core.StateData.Mapper={},this.Core.StateData.Mapper.MAPPER_REG=this.MAPPER_REG.slice(0))},r.prototype.MapperProto.prototype.SetState=function(){if(null!==this.MAPPER_REG)for(var t=0;t<this.Core.StateData.Mapper.MAPPER_REG.length;t++)this.MAPPER_REG[t]=this.Core.StateData.Mapper.MAPPER_REG[t]},r.prototype.Mapper0=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper0.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper0.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,this.Core.PrgRomPageCount-1),this.Core.SetChrRomPage(0)},r.prototype.Mapper1=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(16)},r.prototype.Mapper1.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper1.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.MAPPER_REG[13]=0,this.MAPPER_REG[14]=0,this.MAPPER_REG[0]=12,this.MAPPER_REG[1]=0,this.MAPPER_REG[2]=0,this.MAPPER_REG[3]=0,64===this.Core.PrgRomPageCount?this.MAPPER_REG[10]=2:32===this.Core.PrgRomPageCount?this.MAPPER_REG[10]=1:this.MAPPER_REG[10]=0,this.MAPPER_REG[11]=0,this.MAPPER_REG[12]=0,0===this.MAPPER_REG[10]?(this.MAPPER_REG[8]=2*this.Core.PrgRomPageCount-2,this.MAPPER_REG[9]=2*this.Core.PrgRomPageCount-1):(this.MAPPER_REG[8]=30,this.MAPPER_REG[9]=31),this.MAPPER_REG[4]=0,this.MAPPER_REG[5]=1,this.MAPPER_REG[6]=this.MAPPER_REG[8],this.MAPPER_REG[7]=this.MAPPER_REG[9],this.Core.SetPrgRomPages8K(this.MAPPER_REG[4],this.MAPPER_REG[5],this.MAPPER_REG[6],this.MAPPER_REG[7])},r.prototype.Mapper1.prototype.Write=function(t,e){var s;if((24576&t)!==(24576&this.MAPPER_REG[15])&&(this.MAPPER_REG[13]=0,this.MAPPER_REG[14]=0),this.MAPPER_REG[15]=t,0!==(128&e))return this.MAPPER_REG[13]=0,void(this.MAPPER_REG[14]=0);if(0!==(1&e)&&(this.MAPPER_REG[14]|=1<<this.MAPPER_REG[13]),this.MAPPER_REG[13]++,!(this.MAPPER_REG[13]<5)){s=(32767&t)>>13,this.MAPPER_REG[s]=this.MAPPER_REG[14],this.MAPPER_REG[13]=0,this.MAPPER_REG[14]=0;var r;switch(s){case 0:0!==(2&this.MAPPER_REG[0])?0!==(1&this.MAPPER_REG[0])?this.Core.SetMirror(!0):this.Core.SetMirror(!1):0!==(1&this.MAPPER_REG[0])?this.Core.SetMirrors(1,1,1,1):this.Core.SetMirrors(0,0,0,0);break;case 1:r=this.MAPPER_REG[1],2===this.MAPPER_REG[10]?0!==(16&this.MAPPER_REG[0])?0!==this.MAPPER_REG[12]?(this.MAPPER_REG[11]=(16&this.MAPPER_REG[1])>>4,0!==(8&this.MAPPER_REG[0])&&(this.MAPPER_REG[11]|=(16&this.MAPPER_REG[2])>>3),this.SetPrgRomPages8K_Mapper01(),this.MAPPER_REG[12]=0):this.MAPPER_REG[12]=1:(this.MAPPER_REG[11]=0!==(16&this.MAPPER_REG[1])?3:0,this.SetPrgRomPages8K_Mapper01()):1===this.MAPPER_REG[10]&&0===this.Core.ChrRomPageCount?(this.MAPPER_REG[11]=(16&this.MAPPER_REG[1])>>4,this.SetPrgRomPages8K_Mapper01()):0!==this.Core.ChrRomPageCount?0!==(16&this.MAPPER_REG[0])?(r<<=2,this.Core.SetChrRomPage1K(0,r+0),this.Core.SetChrRomPage1K(1,r+1),this.Core.SetChrRomPage1K(2,r+2),this.Core.SetChrRomPage1K(3,r+3)):(r<<=2,this.Core.SetChrRomPages1K(r+0,r+1,r+2,r+3,r+4,r+5,r+6,r+7)):0!==(16&this.MAPPER_REG[0])&&(r<<=2,this.Core.VRAM[0]=this.Core.VRAMS[r+0],this.Core.VRAM[1]=this.Core.VRAMS[r+1],this.Core.VRAM[2]=this.Core.VRAMS[r+2],this.Core.VRAM[3]=this.Core.VRAMS[r+3]);break;case 2:if(r=this.MAPPER_REG[2],2===this.MAPPER_REG[10]&&0!==(8&this.MAPPER_REG[0])&&(0!==this.MAPPER_REG[12]?(this.MAPPER_REG[11]=(16&this.MAPPER_REG[1])>>4,this.MAPPER_REG[11]|=(16&this.MAPPER_REG[2])>>3,this.SetPrgRomPages8K_Mapper01(),this.MAPPER_REG[12]=0):this.MAPPER_REG[12]=1),0===this.Core.ChrRomPageCount&&0!==(16&this.MAPPER_REG[0])){r<<=2,this.Core.VRAM[4]=this.Core.VRAMS[r+0],this.Core.VRAM[5]=this.Core.VRAMS[r+1],this.Core.VRAM[6]=this.Core.VRAMS[r+2],this.Core.VRAM[7]=this.Core.VRAMS[r+3];break}0!==(16&this.MAPPER_REG[0])&&(r<<=2,this.Core.SetChrRomPage1K(4,r+0),this.Core.SetChrRomPage1K(5,r+1),this.Core.SetChrRomPage1K(6,r+2),this.Core.SetChrRomPage1K(7,r+3));break;case 3:r=this.MAPPER_REG[3],0!==(8&this.MAPPER_REG[0])?(r<<=1,0!==(4&this.MAPPER_REG[0])?(this.MAPPER_REG[4]=r,this.MAPPER_REG[5]=r+1,this.MAPPER_REG[6]=this.MAPPER_REG[8],this.MAPPER_REG[7]=this.MAPPER_REG[9]):0===this.MAPPER_REG[10]&&(this.MAPPER_REG[4]=0,this.MAPPER_REG[5]=1,this.MAPPER_REG[6]=r,this.MAPPER_REG[7]=r+1)):(r<<=1,this.MAPPER_REG[4]=r,this.MAPPER_REG[5]=r+1,0===this.MAPPER_REG[10]&&(this.MAPPER_REG[6]=r+2,this.MAPPER_REG[7]=r+3)),this.SetPrgRomPages8K_Mapper01()}}},r.prototype.Mapper1.prototype.SetPrgRomPages8K_Mapper01=function(){this.Core.SetPrgRomPage8K(0,(this.MAPPER_REG[11]<<5)+(31&this.MAPPER_REG[4])),this.Core.SetPrgRomPage8K(1,(this.MAPPER_REG[11]<<5)+(31&this.MAPPER_REG[5])),this.Core.SetPrgRomPage8K(2,(this.MAPPER_REG[11]<<5)+(31&this.MAPPER_REG[6])),this.Core.SetPrgRomPage8K(3,(this.MAPPER_REG[11]<<5)+(31&this.MAPPER_REG[7]))},r.prototype.Mapper2=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper2.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper2.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,this.Core.PrgRomPageCount-1),this.Core.SetChrRomPage(0)},r.prototype.Mapper2.prototype.Write=function(t,e){this.Core.SetPrgRomPage(0,e)},r.prototype.Mapper3=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper3.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper3.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,this.Core.PrgRomPageCount-1),this.Core.SetChrRomPage(0)},r.prototype.Mapper3.prototype.Write=function(t,e){this.Core.SetChrRomPage(15&e)},r.prototype.Mapper4=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(20)},r.prototype.Mapper4.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper4.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.MAPPER_REG[16]=0,this.MAPPER_REG[17]=1,this.MAPPER_REG[18]=2*(this.Core.PrgRomPageCount-1),this.MAPPER_REG[19]=2*(this.Core.PrgRomPageCount-1)+1,this.Core.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]),this.MAPPER_REG[8]=0,this.MAPPER_REG[9]=1,this.MAPPER_REG[10]=2,this.MAPPER_REG[11]=3,this.MAPPER_REG[12]=4,this.MAPPER_REG[13]=5,this.MAPPER_REG[14]=6,this.MAPPER_REG[15]=7,this.Core.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15])},r.prototype.Mapper4.prototype.Write=function(t,e){switch(57345&t){case 32768:this.MAPPER_REG[0]=e,128===(128&e)?this.Core.SetChrRomPages1K(this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15],this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11]):this.Core.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15]),64===(64&e)?this.Core.SetPrgRomPages8K(this.MAPPER_REG[18],this.MAPPER_REG[17],this.MAPPER_REG[16],this.MAPPER_REG[19]):this.Core.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]);break;case 32769:switch(this.MAPPER_REG[1]=e,7&this.MAPPER_REG[0]){case 0:e&=254,this.MAPPER_REG[8]=e,this.MAPPER_REG[9]=e+1;break;case 1:e&=254,this.MAPPER_REG[10]=e,this.MAPPER_REG[11]=e+1;break;case 2:this.MAPPER_REG[12]=e;break;case 3:this.MAPPER_REG[13]=e;break;case 4:this.MAPPER_REG[14]=e;break;case 5:this.MAPPER_REG[15]=e;break;case 6:this.MAPPER_REG[16]=e;break;case 7:this.MAPPER_REG[17]=e}128===(128&this.MAPPER_REG[0])?this.Core.SetChrRomPages1K(this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15],this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11]):this.Core.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15]),64===(64&this.MAPPER_REG[0])?this.Core.SetPrgRomPages8K(this.MAPPER_REG[18],this.MAPPER_REG[17],this.MAPPER_REG[16],this.MAPPER_REG[19]):this.Core.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]);break;case 40960:1===(1&e)?this.Core.SetMirror(!0):this.Core.SetMirror(!1),this.MAPPER_REG[2]=e;break;case 40961:this.MAPPER_REG[3]=e;break;case 49152:this.MAPPER_REG[4]=e;break;case 49153:this.MAPPER_REG[5]=e;break;case 57344:this.MAPPER_REG[4]=this.MAPPER_REG[5],this.MAPPER_REG[7]=0,this.ClearIRQ();break;case 57345:this.MAPPER_REG[7]=1}},r.prototype.Mapper4.prototype.HSync=function(t){1===this.MAPPER_REG[7]&&240>t&&8===(8&this.Core.IO1[1])&&(0===--this.MAPPER_REG[4]&&this.SetIRQ(),this.MAPPER_REG[4]&=255)},r.prototype.Mapper5=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(768),this.MAPPER_EXRAM=new Array(8),this.MAPPER_EXRAM2=new Array(1024),this.MAPPER_EXRAM3=new Array(1024),this.MAPPER_CHR_REG=new Array(2),this.MAPPER_IRQ=0,this.MAPPER_IRQ_STATUS=0},r.prototype.Mapper5.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper5.prototype.Init=function(){this.MAPPER_IRQ=0,this.MAPPER_IRQ_STATUS=0;var t,e;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;for(t=0;t<this.MAPPER_EXRAM.length;t++)for(this.MAPPER_EXRAM[t]=new Array(8192),e=0;e<this.MAPPER_EXRAM[t].length;e++)this.MAPPER_EXRAM[t][e]=0;for(t=0;t<this.MAPPER_EXRAM2.length;t++)this.MAPPER_EXRAM2[t]=0;for(t=0;t<this.MAPPER_EXRAM3.length;t++)this.MAPPER_EXRAM3[t]=0;for(t=0;t<this.MAPPER_CHR_REG.length;t++)for(this.MAPPER_CHR_REG[t]=new Array(8),e=0;e<this.MAPPER_CHR_REG[t].length;e++)this.MAPPER_CHR_REG[t][e]=0;var s=2*this.Core.PrgRomPageCount-1;this.Core.SetPrgRomPages8K(s,s,s,s),s=0,this.Core.SetChrRomPages1K(s,s+1,s+2,s+3,s+4,s+5,s+6,s+7)},r.prototype.Mapper5.prototype.HSync=function(t){240>t?(this.MAPPER_IRQ_STATUS|=64,t===this.MAPPER_REG[515]&&(this.MAPPER_IRQ_STATUS|=128),128===(128&this.MAPPER_IRQ_STATUS)&&128===(128&this.MAPPER_REG[516])&&this.SetIRQ()):this.MAPPER_IRQ_STATUS&=191},r.prototype.Mapper5.prototype.ReadLow=function(t){if(t>=23552)return this.MAPPER_EXRAM2[t-23552];if(20996===t){var e=this.MAPPER_IRQ_STATUS;return this.MAPPER_IRQ_STATUS&=127,this.ClearIRQ(),e}return 20997===t?this.MAPPER_REG[517]*this.MAPPER_REG[518]&255:20998===t?this.MAPPER_REG[517]*this.MAPPER_REG[518]>>>8:void 0},r.prototype.Mapper5.prototype.WriteLow=function(t,e){var s;if(t>=23552)return void(this.MAPPER_EXRAM2[t-23552]=e);if(t>=20480&&20501>=t)return this.MAPPER_REG[t-20480]=e,void this.Core.Write_MMC5_REG(t-20480,e);if(t>=20736&&20740>=t||20784===t||t>=20992&&20998>=t)return void(this.MAPPER_REG[t-20480]=e);if(20741!==t)if(20742!==t){if(20743!==t)return 20755===t?(this.MAPPER_REG[275]=e,void(this.Core.SRAM=this.MAPPER_EXRAM[7&e])):t>=20756&&20759>=t?(this.MAPPER_REG[t-20480]=e,void this.SetPrgRomPages8K_Mapper05(t-20480)):t>=20768&&20775>=t?(this.MAPPER_REG[t-20480]=this.MAPPER_REG[304]<<8|e,void this.SetChrRomPages1K_Mapper05_A()):t>=20776&&20779>=t?(this.MAPPER_REG[t-20480]=this.MAPPER_REG[304]<<8|e,void this.SetChrRomPages1K_Mapper05_B()):void 0;for(this.MAPPER_REG[263]=e,s=960;1024>s;s++)this.MAPPER_EXRAM3[s]=e}else for(this.MAPPER_REG[262]=e,s=0;960>s;s++)this.MAPPER_EXRAM3[s]=e;else for(this.MAPPER_REG[261]=e,s=0;4>s;s++)switch(e>>>2*s&3){case 0:this.Core.VRAM[8+s]=this.Core.VRAMS[8];break;case 1:this.Core.VRAM[8+s]=this.Core.VRAMS[9];break;case 2:this.Core.VRAM[8+s]=this.MAPPER_EXRAM2;break;case 3:this.Core.VRAM[8+s]=this.MAPPER_EXRAM3}},r.prototype.Mapper5.prototype.SetChrRomPages1K_Mapper05_A=function(){var t;switch(3&this.MAPPER_REG[257]){case 0:t=8*this.MAPPER_REG[295],this.MAPPER_CHR_REG[0][0]=t,this.MAPPER_CHR_REG[0][1]=t+1,this.MAPPER_CHR_REG[0][2]=t+2,this.MAPPER_CHR_REG[0][3]=t+3,this.MAPPER_CHR_REG[0][4]=t+4,this.MAPPER_CHR_REG[0][5]=t+5,this.MAPPER_CHR_REG[0][6]=t+6,this.MAPPER_CHR_REG[0][7]=t+7;break;case 1:t=4*this.MAPPER_REG[291],this.MAPPER_CHR_REG[0][0]=t,this.MAPPER_CHR_REG[0][1]=t+1,this.MAPPER_CHR_REG[0][2]=t+2,this.MAPPER_CHR_REG[0][3]=t+3,t=4*this.MAPPER_REG[295],this.MAPPER_CHR_REG[0][4]=t,this.MAPPER_CHR_REG[0][5]=t+1,this.MAPPER_CHR_REG[0][6]=t+2,this.MAPPER_CHR_REG[0][7]=t+3;break;case 2:t=2*this.MAPPER_REG[289],this.MAPPER_CHR_REG[0][0]=t,this.MAPPER_CHR_REG[0][1]=t+1,t=2*this.MAPPER_REG[291],this.MAPPER_CHR_REG[0][2]=t,this.MAPPER_CHR_REG[0][3]=t+1,t=2*this.MAPPER_REG[293],this.MAPPER_CHR_REG[0][4]=t,this.MAPPER_CHR_REG[0][5]=t+1,t=2*this.MAPPER_REG[294],this.MAPPER_CHR_REG[0][6]=t,this.MAPPER_CHR_REG[0][7]=t+1;break;case 3:this.MAPPER_CHR_REG[0][0]=this.MAPPER_REG[288],this.MAPPER_CHR_REG[0][1]=this.MAPPER_REG[289],this.MAPPER_CHR_REG[0][2]=this.MAPPER_REG[290],this.MAPPER_CHR_REG[0][3]=this.MAPPER_REG[291],this.MAPPER_CHR_REG[0][4]=this.MAPPER_REG[292],this.MAPPER_CHR_REG[0][5]=this.MAPPER_REG[293],this.MAPPER_CHR_REG[0][6]=this.MAPPER_REG[294],this.MAPPER_CHR_REG[0][7]=this.MAPPER_REG[295]}},r.prototype.Mapper5.prototype.SetChrRomPages1K_Mapper05_B=function(){var t;switch(3&this.MAPPER_REG[257]){case 0:t=8*this.MAPPER_REG[299],this.MAPPER_CHR_REG[1][0]=t,this.MAPPER_CHR_REG[1][1]=t+1,this.MAPPER_CHR_REG[1][2]=t+2,this.MAPPER_CHR_REG[1][3]=t+3,this.MAPPER_CHR_REG[1][4]=t+4,this.MAPPER_CHR_REG[1][5]=t+5,this.MAPPER_CHR_REG[1][6]=t+6,this.MAPPER_CHR_REG[1][7]=t+7;break;case 1:t=4*this.MAPPER_REG[299],this.MAPPER_CHR_REG[1][0]=t,this.MAPPER_CHR_REG[1][1]=t+1,this.MAPPER_CHR_REG[1][2]=t+2,this.MAPPER_CHR_REG[1][3]=t+3,this.MAPPER_CHR_REG[1][4]=t,this.MAPPER_CHR_REG[1][5]=t+1,this.MAPPER_CHR_REG[1][6]=t+2,this.MAPPER_CHR_REG[1][7]=t+3;break;case 2:t=2*this.MAPPER_REG[297],this.MAPPER_CHR_REG[1][0]=t,this.MAPPER_CHR_REG[1][1]=t+1,this.MAPPER_CHR_REG[1][4]=t,this.MAPPER_CHR_REG[1][5]=t+1,t=2*this.MAPPER_REG[299],this.MAPPER_CHR_REG[1][2]=t,this.MAPPER_CHR_REG[1][3]=t+1,this.MAPPER_CHR_REG[1][6]=t,this.MAPPER_CHR_REG[1][7]=t+1;break;case 3:t=this.MAPPER_REG[296],this.MAPPER_CHR_REG[1][0]=t,this.MAPPER_CHR_REG[1][4]=t,t=this.MAPPER_REG[297],this.MAPPER_CHR_REG[1][1]=t,this.MAPPER_CHR_REG[1][5]=t,t=this.MAPPER_REG[298],this.MAPPER_CHR_REG[1][2]=t,this.MAPPER_CHR_REG[1][6]=t,t=this.MAPPER_REG[299],this.MAPPER_CHR_REG[1][3]=t,this.MAPPER_CHR_REG[1][7]=t}},r.prototype.Mapper5.prototype.SetPrgRomPages8K_Mapper05=function(t){var e;switch(3&this.MAPPER_REG[256]){case 0:279===t&&(e=124&this.MAPPER_REG[279],this.Core.SetPrgRomPage8K(0,e),this.Core.SetPrgRomPage8K(1,e+1),this.Core.SetPrgRomPage8K(2,e+2),this.Core.SetPrgRomPage8K(3,e+3));break;case 1:277===t&&(e=this.MAPPER_REG[277],128===(128&e)?(e&=126,this.Core.SetPrgRomPage8K(0,e),this.Core.SetPrgRomPage8K(1,e+1)):(this.Core.ROM[0]=this.MAPPER_EXRAM[7&e],this.Core.ROM[1]=this.MAPPER_EXRAM[e+1&7])),279===t&&(e=126&this.MAPPER_REG[279],this.Core.SetPrgRomPage8K(2,e),this.Core.SetPrgRomPage8K(3,e+1));break;case 2:277===t&&(e=this.MAPPER_REG[277],128===(128&e)?(e&=126,this.Core.SetPrgRomPage8K(0,e),this.Core.SetPrgRomPage8K(1,e+1)):(this.Core.ROM[0]=this.MAPPER_EXRAM[7&e],this.Core.ROM[1]=this.MAPPER_EXRAM[e+1&7])),278===t&&(e=this.MAPPER_REG[278],128===(128&e)?this.Core.SetPrgRomPage8K(2,127&e):this.Core.ROM[2]=this.MAPPER_EXRAM[7&e]),279===t&&this.Core.SetPrgRomPage8K(3,127&this.MAPPER_REG[279]);break;case 3:276!==t&&277!==t&&278!==t||(e=this.MAPPER_REG[t],128===(128&e)?this.Core.SetPrgRomPage8K(t-276,127&e):this.Core.ROM[t-276]=this.MAPPER_EXRAM[7&e]),279===t&&this.Core.SetPrgRomPage8K(3,127&this.MAPPER_REG[279])}},r.prototype.Mapper5.prototype.BuildBGLine=function(){if(this.Core.SetChrRomPages1K(this.MAPPER_CHR_REG[1][0],this.MAPPER_CHR_REG[1][1],this.MAPPER_CHR_REG[1][2],this.MAPPER_CHR_REG[1][3],this.MAPPER_CHR_REG[1][4],this.MAPPER_CHR_REG[1][5],this.MAPPER_CHR_REG[1][6],this.MAPPER_CHR_REG[1][7]),this.Core.BuildBGLine_SUB(),128===(128&this.MAPPER_REG[512])){var t=4*this.MAPPER_REG[514];this.Core.SetChrRomPage1K(0,t),this.Core.SetChrRomPage1K(1,t+1),this.Core.SetChrRomPage1K(2,t+2),this.Core.SetChrRomPage1K(3,t+3);var e,s,r=31&this.MAPPER_REG[512];0===(64&this.MAPPER_REG[512])?(e=0,s=r-1):(e=r,s=31);var i=this.Core.VRAM,h=this.Core.PaletteArray,o=this.Core.SPBitArray,a=this.Core.BgLineBuffer,P=0,R=(this.Core.PpuY+this.MAPPER_REG[513])%240;P+=R>>>3<<5;for(var p=7&R,E=e;s>=E;E++){var C=(this.MAPPER_EXRAM2[P+E]<<4)+p,M=i[C>>10];C&=1023;for(var A=this.MAPPER_EXRAM2[(896&P)>>4|((28&P)>>2)+960]<<2>>((64&P)>>4|2&P)&12,n=o[M[C]][M[C+8]],_=0;8>_;_++)a[8*E+_]=h[n[_]|A]}}},r.prototype.Mapper5.prototype.BuildSpriteLine=function(){this.Core.SetChrRomPages1K(this.MAPPER_CHR_REG[0][0],this.MAPPER_CHR_REG[0][1],this.MAPPER_CHR_REG[0][2],this.MAPPER_CHR_REG[0][3],this.MAPPER_CHR_REG[0][4],this.MAPPER_CHR_REG[0][5],this.MAPPER_CHR_REG[0][6],this.MAPPER_CHR_REG[0][7]),this.Core.BuildSpriteLine_SUB()},r.prototype.Mapper5.prototype.ReadPPUData=function(){return this.Core.SetChrRomPages1K(this.MAPPER_CHR_REG[0][0],this.MAPPER_CHR_REG[0][1],this.MAPPER_CHR_REG[0][2],this.MAPPER_CHR_REG[0][3],this.MAPPER_CHR_REG[0][4],this.MAPPER_CHR_REG[0][5],this.MAPPER_CHR_REG[0][6],this.MAPPER_CHR_REG[0][7]),this.Core.ReadPPUData_SUB()},r.prototype.Mapper5.prototype.WritePPUData=function(t){this.Core.SetChrRomPages1K(this.MAPPER_CHR_REG[0][0],this.MAPPER_CHR_REG[0][1],this.MAPPER_CHR_REG[0][2],this.MAPPER_CHR_REG[0][3],this.MAPPER_CHR_REG[0][4],this.MAPPER_CHR_REG[0][5],this.MAPPER_CHR_REG[0][6],this.MAPPER_CHR_REG[0][7]),this.Core.WritePPUData_SUB(t)},r.prototype.Mapper5.prototype.OutEXSound=function(t){return(t>>1)+(this.Core.Out_MMC5()>>1)},r.prototype.Mapper5.prototype.EXSoundSync=function(t){this.Core.Count_MMC5(t)},r.prototype.Mapper7=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper7.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper7.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,1),this.Core.SetChrRomPage(0)},r.prototype.Mapper7.prototype.Write=function(t,e){var s=(7&e)<<1;this.Core.SetPrgRomPage(0,s),this.Core.SetPrgRomPage(1,s+1),0===(16&e)?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1)},r.prototype.Mapper9=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(4),this.MAPPER_Latch0=!0,this.MAPPER_Latch1=!0},r.prototype.Mapper9.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper9.prototype.Init=function(){this.Core.SetPrgRomPages8K(0,2*this.Core.PrgRomPageCount-3,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,0,0,0,0,0,0,0);for(var t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.MAPPER_Latch0=!0,this.MAPPER_Latch1=!0},r.prototype.Mapper9.prototype.Write=function(t,e){switch(61440&t){case 40960:this.Core.SetPrgRomPage8K(0,e);break;case 45056:this.MAPPER_REG[0]=e;break;case 49152:this.MAPPER_REG[1]=e;break;case 53248:this.MAPPER_REG[2]=e;break;case 57344:this.MAPPER_REG[3]=e;break;case 61440:0===(1&e)?this.Core.SetMirror(!1):this.Core.SetMirror(!0)}},r.prototype.Mapper9.prototype.BuildBGLine=function(){for(var t=this.Core.BgLineBuffer,e=this.Core.VRAM,s=8192|4095&this.Core.PPUAddress,r=(28672&this.Core.PPUAddress)>>12|(16&this.Core.IO1[0])<<8,i=s>>10,h=1023&s,o=e[i],a=this.Core.PaletteArray,P=this.Core.SPBitArray,R=0,p=this.Core.HScrollTmp,E=0;33>E;E++){var C=o[h]<<4|r,M=C;this.SetChrRom(M);var A=e[C>>10];C&=1023;for(var n=o[(896&h)>>4|((28&h)>>2)+960]<<2>>((64&h)>>4|2&h)&12,_=P[A[C]][A[C+8]];8>p;p++,R++)t[R]=a[_[p]|n];p=0,this.SetLatch(M),31===(31&h)?(h&=65504,o=e[i^=1]):h++}},r.prototype.Mapper9.prototype.SetLatch=function(t){t&=8176,4048===t&&(this.MAPPER_Latch0=!1),8144===t&&(this.MAPPER_Latch1=!1),4064===t&&(this.MAPPER_Latch0=!0),8160===t&&(this.MAPPER_Latch1=!0)},r.prototype.Mapper9.prototype.SetChrRom=function(t){0===(4096&t)?this.MAPPER_Latch0?(this.Core.SetChrRomPage1K(0,4*this.MAPPER_REG[1]),this.Core.SetChrRomPage1K(1,4*this.MAPPER_REG[1]+1),this.Core.SetChrRomPage1K(2,4*this.MAPPER_REG[1]+2),this.Core.SetChrRomPage1K(3,4*this.MAPPER_REG[1]+3)):(this.Core.SetChrRomPage1K(0,4*this.MAPPER_REG[0]),this.Core.SetChrRomPage1K(1,4*this.MAPPER_REG[0]+1),this.Core.SetChrRomPage1K(2,4*this.MAPPER_REG[0]+2),this.Core.SetChrRomPage1K(3,4*this.MAPPER_REG[0]+3)):this.MAPPER_Latch1?(this.Core.SetChrRomPage1K(4,4*this.MAPPER_REG[3]),this.Core.SetChrRomPage1K(5,4*this.MAPPER_REG[3]+1),this.Core.SetChrRomPage1K(6,4*this.MAPPER_REG[3]+2),this.Core.SetChrRomPage1K(7,4*this.MAPPER_REG[3]+3)):(this.Core.SetChrRomPage1K(4,4*this.MAPPER_REG[2]),this.Core.SetChrRomPage1K(5,4*this.MAPPER_REG[2]+1),this.Core.SetChrRomPage1K(6,4*this.MAPPER_REG[2]+2),this.Core.SetChrRomPage1K(7,4*this.MAPPER_REG[2]+3))},r.prototype.Mapper9.prototype.BuildSpriteLine=function(){var t=this.Core.BgLineBuffer,e=4===(4&this.Core.IO1[1])?0:8;if(16===(16&this.Core.IO1[1])){for(var s=this.Core.SpriteLineBuffer,r=0;256>r;r++)s[r]=256;for(var i=this.Core.SPRITE_RAM,h=32===(32&this.Core.IO1[0])?16:8,o=(8&this.Core.IO1[0])<<9,a=this.Core.VRAM,P=this.Core.SPBitArray,R=this.Core.PpuY,p=0,E=0;252>=E;E+=4){var C=i[E]+1;if(!(C>R||R>=C+h))if(0===E&&(this.Core.Sprite0Line=!0),9===++p&&this.Core.SpriteLimit)E=256;else{var M=i[E+3],A=M+8;A>256&&(A=256);var n=i[E+2],_=(3&n)<<2|16,c=32&n,G=128===(128&n)?h-1-(R-C):R-C,S=((8&G)<<1)+(7&G)+(8===h?(i[E+1]<<4)+o:((254&i[E+1])<<4)+((1&i[E+1])<<12));this.SetChrRom(S);var u,g,y=a[S>>10],d=1023&S,m=P[y[d]][y[d+8]];for(0===(64&n)?(u=0,g=1):(u=7,g=-1);A>M;M++,u+=g){var b=m[u];0!==b&&256===s[M]&&(s[M]=E,M>=e&&(0===c||16===t[M])&&(t[M]=b|_))}this.SetLatch(S)}}p>=8?this.Core.IO1[2]|=32:this.Core.IO1[2]&=223}},r.prototype.Mapper9.prototype.GetState=function(){this.Core.StateData.Mapper={},this.Core.StateData.Mapper.MAPPER_REG=this.MAPPER_REG.slice(0),this.Core.StateData.Mapper.MAPPER_Latch0=this.MAPPER_Latch0,this.Core.StateData.Mapper.MAPPER_Latch1=this.MAPPER_Latch1},r.prototype.Mapper9.prototype.SetState=function(){for(var t=0;t<this.Core.StateData.Mapper.MAPPER_REG.length;t++)this.MAPPER_REG[t]=this.Core.StateData.Mapper.MAPPER_REG[t];this.MAPPER_Latch0=this.Core.StateData.Mapper.MAPPER_Latch0,this.MAPPER_Latch1=this.Core.StateData.Mapper.MAPPER_Latch1},r.prototype.Mapper10=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(4),this.MAPPER_Latch0=!0,this.MAPPER_Latch1=!0},r.prototype.Mapper10.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper10.prototype.Init=function(){this.Core.SetPrgRomPages8K(0,0,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,0,0,0,0,0,0,0);for(var t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.MAPPER_Latch0=!0,this.MAPPER_Latch1=!0},r.prototype.Mapper10.prototype.Write=function(t,e){switch(61440&t){case 40960:this.Core.SetPrgRomPage8K(0,2*e),this.Core.SetPrgRomPage8K(1,2*e+1);break;case 45056:this.MAPPER_REG[0]=e;break;case 49152:this.MAPPER_REG[1]=e;break;case 53248:this.MAPPER_REG[2]=e;break;case 57344:this.MAPPER_REG[3]=e;break;case 61440:0===(1&e)?this.Core.SetMirror(!1):this.Core.SetMirror(!0)}},r.prototype.Mapper10.prototype.BuildBGLine=function(){for(var t=this.Core.BgLineBuffer,e=this.Core.VRAM,s=8192|4095&this.Core.PPUAddress,r=(28672&this.Core.PPUAddress)>>12|(16&this.Core.IO1[0])<<8,i=s>>10,h=1023&s,o=e[i],a=this.Core.PaletteArray,P=this.Core.SPBitArray,R=0,p=this.Core.HScrollTmp,E=0;33>E;E++){var C=o[h]<<4|r,M=C;this.SetChrRom(M);var A=e[C>>10];C&=1023;for(var n=o[(896&h)>>4|((28&h)>>2)+960]<<2>>((64&h)>>4|2&h)&12,_=P[A[C]][A[C+8]];8>p;p++,R++)t[R]=a[_[p]|n];p=0,this.SetLatch(M),31===(31&h)?(h&=65504,o=e[i^=1]):h++}},r.prototype.Mapper10.prototype.SetLatch=function(t){t&=8176,4048===t&&(this.MAPPER_Latch0=!1),8144===t&&(this.MAPPER_Latch1=!1),4064===t&&(this.MAPPER_Latch0=!0),8160===t&&(this.MAPPER_Latch1=!0)},r.prototype.Mapper10.prototype.SetChrRom=function(t){0===(4096&t)?this.MAPPER_Latch0?(this.Core.SetChrRomPage1K(0,4*this.MAPPER_REG[1]),this.Core.SetChrRomPage1K(1,4*this.MAPPER_REG[1]+1),this.Core.SetChrRomPage1K(2,4*this.MAPPER_REG[1]+2),this.Core.SetChrRomPage1K(3,4*this.MAPPER_REG[1]+3)):(this.Core.SetChrRomPage1K(0,4*this.MAPPER_REG[0]),this.Core.SetChrRomPage1K(1,4*this.MAPPER_REG[0]+1),this.Core.SetChrRomPage1K(2,4*this.MAPPER_REG[0]+2),this.Core.SetChrRomPage1K(3,4*this.MAPPER_REG[0]+3)):this.MAPPER_Latch1?(this.Core.SetChrRomPage1K(4,4*this.MAPPER_REG[3]),this.Core.SetChrRomPage1K(5,4*this.MAPPER_REG[3]+1),this.Core.SetChrRomPage1K(6,4*this.MAPPER_REG[3]+2),this.Core.SetChrRomPage1K(7,4*this.MAPPER_REG[3]+3)):(this.Core.SetChrRomPage1K(4,4*this.MAPPER_REG[2]),this.Core.SetChrRomPage1K(5,4*this.MAPPER_REG[2]+1),this.Core.SetChrRomPage1K(6,4*this.MAPPER_REG[2]+2),this.Core.SetChrRomPage1K(7,4*this.MAPPER_REG[2]+3))},r.prototype.Mapper10.prototype.BuildSpriteLine=function(){var t=this.Core.BgLineBuffer,e=4===(4&this.Core.IO1[1])?0:8;if(16===(16&this.Core.IO1[1])){for(var s=this.Core.SpriteLineBuffer,r=0;256>r;r++)s[r]=256;for(var i=this.Core.SPRITE_RAM,h=32===(32&this.Core.IO1[0])?16:8,o=(8&this.Core.IO1[0])<<9,a=this.Core.VRAM,P=this.Core.SPBitArray,R=this.Core.PpuY,p=0,E=0;252>=E;E+=4){var C=i[E]+1;if(!(C>R||R>=C+h))if(0===E&&(this.Core.Sprite0Line=!0),9===++p&&this.Core.SpriteLimit)E=256;else{var M=i[E+3],A=M+8;A>256&&(A=256);var n=i[E+2],_=(3&n)<<2|16,c=32&n,G=128===(128&n)?h-1-(R-C):R-C,S=((8&G)<<1)+(7&G)+(8===h?(i[E+1]<<4)+o:((254&i[E+1])<<4)+((1&i[E+1])<<12));this.SetChrRom(S);var u,g,y=a[S>>10],d=1023&S,m=P[y[d]][y[d+8]];for(0===(64&n)?(u=0,g=1):(u=7,g=-1);A>M;M++,u+=g){var b=m[u];0!==b&&256===s[M]&&(s[M]=E,M>=e&&(0===c||16===t[M])&&(t[M]=b|_))}this.SetLatch(S)}}p>=8?this.Core.IO1[2]|=32:this.Core.IO1[2]&=223}},r.prototype.Mapper10.prototype.GetState=function(){this.Core.StateData.Mapper={},this.Core.StateData.Mapper.MAPPER_REG=this.MAPPER_REG.slice(0),this.Core.StateData.Mapper.MAPPER_Latch0=this.MAPPER_Latch0,this.Core.StateData.Mapper.MAPPER_Latch1=this.MAPPER_Latch1},r.prototype.Mapper10.prototype.SetState=function(){for(var t=0;t<this.Core.StateData.Mapper.MAPPER_REG.length;t++)this.MAPPER_REG[t]=this.Core.StateData.Mapper.MAPPER_REG[t];this.MAPPER_Latch0=this.Core.StateData.Mapper.MAPPER_Latch0,this.MAPPER_Latch1=this.Core.StateData.Mapper.MAPPER_Latch1},r.prototype.Mapper16=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(5),this.EEPROM_ADDRESS=0,this.OUT_DATA=0,this.BIT_DATA=0,this.BIT_DATA_TMP=0,this.BIT_COUNTER=0,this.READ_WRITE=!1,this.SCL_OLD=!1,this.SCL=!1,this.SDA_OLD=!1,this.SDA=!1,this.STATE=0,this.EEPROM=new Array(256);for(var e=0;e<this.EEPROM.length;e++)this.EEPROM[e]=0},r.prototype.Mapper16.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper16.prototype.Init=function(){this.MAPPER_REG[0]=0,this.MAPPER_REG[1]=0,this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7),this.EEPROM_ADDRESS=0,this.OUT_DATA=0,this.BIT_DATA=0,this.BIT_DATA_TMP=0,this.BIT_COUNTER=0,this.READ_WRITE=!1,this.SCL_OLD=!1,this.SCL=!1,this.SDA_OLD=!1,this.SDA=!1,this.STATE=0},r.prototype.Mapper16.prototype.Write=function(t,e){switch(15&t){case 0:this.Core.SetChrRomPage1K(0,e);break;case 1:this.Core.SetChrRomPage1K(1,e);break;case 2:this.Core.SetChrRomPage1K(2,e);break;case 3:this.Core.SetChrRomPage1K(3,e);break;case 4:this.Core.SetChrRomPage1K(4,e);break;case 5:this.Core.SetChrRomPage1K(5,e);break;case 6:this.Core.SetChrRomPage1K(6,e);break;case 7:this.Core.SetChrRomPage1K(7,e);break;case 8:this.Core.SetPrgRomPage8K(0,2*e),this.Core.SetPrgRomPage8K(1,2*e+1);break;case 9:e&=3,0===e?this.Core.SetMirror(!1):1===e?this.Core.SetMirror(!0):2===e?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1);break;case 10:this.MAPPER_REG[0]=1&e,this.ClearIRQ();break;case 11:this.MAPPER_REG[1]=65280&this.MAPPER_REG[1]|e;break;case 12:this.MAPPER_REG[1]=255&this.MAPPER_REG[1]|e<<8;break;case 13:if(this.SCL_OLD=this.SCL,this.SCL=32===(32&e),this.SDA_OLD=this.SDA,this.SDA=64===(64&e),this.SCL_OLD&&this.SCL&&this.SDA_OLD&&!this.SDA&&(this.STATE=1,this.BIT_DATA_TMP=0,this.BIT_COUNTER=0),this.SCL_OLD&&this.SCL&&!this.SDA_OLD&&this.SDA&&(this.STATE=0),!this.SCL_OLD&&this.SCL)switch(this.STATE){case 1:this.BIT_IN()&&(this.READ_WRITE=1===(1&this.BIT_DATA),this.STATE=this.READ_WRITE?4:2);break;case 2:this.BIT_IN()&&(this.STATE=3,this.EEPROM_ADDRESS=this.BIT_DATA);break;case 3:this.BIT_IN()&&(this.EEPROM[this.EEPROM_ADDRESS]=this.BIT_DATA,this.EEPROM_ADDRESS=this.EEPROM_ADDRESS+1&255);break;case 4:0===this.BIT_COUNTER&&(this.BIT_DATA=this.EEPROM[this.EEPROM_ADDRESS],this.EEPROM_ADDRESS=this.EEPROM_ADDRESS+1&255),this.BIT_OUT()}}},r.prototype.Mapper16.prototype.BIT_OUT=function(){return 8===this.BIT_COUNTER?(this.BIT_COUNTER=0,!0):(this.OUT_DATA=(128&this.BIT_DATA)>>>3,this.BIT_DATA=this.BIT_DATA<<1&255,this.BIT_COUNTER++,!1)},r.prototype.Mapper16.prototype.BIT_IN=function(){return 8===this.BIT_COUNTER?(this.BIT_COUNTER=0,this.OUT_DATA=0,!0):(this.BIT_DATA=255&(this.BIT_DATA<<1|(this.SDA?1:0)),this.BIT_COUNTER++,!1)},r.prototype.Mapper16.prototype.ReadSRAM=function(t){return this.OUT_DATA},r.prototype.Mapper16.prototype.WriteSRAM=function(t,e){this.Write(t,e)},r.prototype.Mapper16.prototype.CPUSync=function(t){1===this.MAPPER_REG[0]&&(0===this.MAPPER_REG[1]&&(this.MAPPER_REG[1]=65536),this.MAPPER_REG[1]-=t,this.MAPPER_REG[1]<=0&&(this.SetIRQ(),this.MAPPER_REG[0]=0,this.MAPPER_REG[1]=0))},r.prototype.Mapper18=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(15),this.IRQ_Counter=0},r.prototype.Mapper18.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper18.prototype.Init=function(){for(var t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.IRQ_Counter=0,this.Core.SetPrgRomPages8K(0,1,2,2*this.Core.PrgRomPageCount-1),
this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper18.prototype.Write=function(t,e){if(t>=32768&&57344>t){var s=(28672&t)>>>11|(2&t)>>>1;return 0===(1&t)?this.MAPPER_REG[s]=240&this.MAPPER_REG[s]|15&e:this.MAPPER_REG[s]=15&this.MAPPER_REG[s]|(15&e)<<4,3>s&&this.Core.SetPrgRomPage8K(s,this.MAPPER_REG[s]),void(s>=4&&this.Core.SetChrRomPage1K(s-4,this.MAPPER_REG[s]))}switch(61443&t){case 57344:case 57345:case 57346:case 57347:var r=4*(3&t);this.MAPPER_REG[12]=this.MAPPER_REG[12]&~(15<<r)|(15&e)<<r;break;case 61440:this.IRQ_Counter=this.MAPPER_REG[12],this.ClearIRQ();break;case 61441:this.MAPPER_REG[13]=e,this.ClearIRQ();break;case 61442:this.MAPPER_REG[14]=e,e&=3,0===e?this.Core.SetMirror(!0):1===e?this.Core.SetMirror(!1):2===e?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1)}},r.prototype.Mapper18.prototype.CPUSync=function(t){if(1===(1&this.MAPPER_REG[13])){var e;switch(14&this.MAPPER_REG[13]){case 0:e=65535;break;case 2:e=4095;break;case 4:case 6:e=255;break;case 8:case 10:case 12:case 14:e=15}var s=(this.IRQ_Counter&e)-t;0>s&&this.SetIRQ(),this.IRQ_Counter=this.IRQ_Counter&~e|s&e}},r.prototype.Mapper19=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(5),this.EX_VRAM=new Array(32)},r.prototype.Mapper19.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper19.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;for(t=0;t<this.EX_VRAM.length;t++){this.EX_VRAM[t]=new Array(1024);for(var e=0;e<this.EX_VRAM[t].length;e++)this.EX_VRAM[t][e]=0}this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.ChrRomPageCount>=1&&this.Core.SetChrRomPages1K(8*this.Core.ChrRomPageCount-8,8*this.Core.ChrRomPageCount-7,8*this.Core.ChrRomPageCount-6,8*this.Core.ChrRomPageCount-5,8*this.Core.ChrRomPageCount-4,8*this.Core.ChrRomPageCount-3,8*this.Core.ChrRomPageCount-2,8*this.Core.ChrRomPageCount-1)},r.prototype.Mapper19.prototype.ReadLow=function(t){switch(63488&t){case 18432:return this.Core.Read_N163_RAM();case 20480:return this.ClearIRQ(),255&this.MAPPER_REG[4];case 22528:return this.ClearIRQ(),this.MAPPER_REG[3]<<7|(32512&this.MAPPER_REG[4])>>8}return 0},r.prototype.Mapper19.prototype.WriteLow=function(t,e){switch(63488&t){case 18432:18432===t&&this.Core.Write_N163_RAM(e);break;case 20480:this.MAPPER_REG[4]=65280&this.MAPPER_REG[4]|e,this.ClearIRQ();break;case 22528:this.MAPPER_REG[4]=255&this.MAPPER_REG[4]|(127&e)<<8,this.MAPPER_REG[3]=(128&e)>>7,this.ClearIRQ()}},r.prototype.Mapper19.prototype.Write=function(t,e){switch(63488&t){case 32768:224>e||1===this.MAPPER_REG[0]?this.Core.SetChrRomPage1K(0,e):this.Core.VRAM[0]=this.EX_VRAM[224&e];break;case 34816:224>e||1===this.MAPPER_REG[0]?this.Core.SetChrRomPage1K(1,e):this.Core.VRAM[1]=this.EX_VRAM[224&e];break;case 36864:224>e||1===this.MAPPER_REG[0]?this.Core.SetChrRomPage1K(2,e):this.Core.VRAM[2]=this.EX_VRAM[224&e];break;case 38912:224>e||1===this.MAPPER_REG[0]?this.Core.SetChrRomPage1K(3,e):this.Core.VRAM[3]=this.EX_VRAM[224&e];break;case 40960:224>e||1===this.MAPPER_REG[1]?this.Core.SetChrRomPage1K(4,e):this.Core.VRAM[4]=this.EX_VRAM[224&e];break;case 43008:224>e||1===this.MAPPER_REG[1]?this.Core.SetChrRomPage1K(5,e):this.Core.VRAM[5]=this.EX_VRAM[224&e];break;case 45056:224>e||1===this.MAPPER_REG[1]?this.Core.SetChrRomPage1K(6,e):this.Core.VRAM[6]=this.EX_VRAM[224&e];break;case 47104:224>e||1===this.MAPPER_REG[1]?this.Core.SetChrRomPage1K(7,e):this.Core.VRAM[7]=this.EX_VRAM[224&e];break;case 49152:224>e?this.Core.SetChrRomPage1K(8,e):this.Core.VRAM[8]=this.Core.VRAMS[(1&e)+8];break;case 51200:224>e?this.Core.SetChrRomPage1K(9,e):this.Core.VRAM[9]=this.Core.VRAMS[(1&e)+8];break;case 53248:224>e?this.Core.SetChrRomPage1K(10,e):this.Core.VRAM[10]=this.Core.VRAMS[(1&e)+8];break;case 55296:224>e?this.Core.SetChrRomPage1K(11,e):this.Core.VRAM[11]=this.Core.VRAMS[(1&e)+8];break;case 57344:this.Core.SetPrgRomPage8K(0,63&e);break;case 59392:this.Core.SetPrgRomPage8K(1,63&e),this.MAPPER_REG[0]=(64&e)>>6,this.MAPPER_REG[1]=(128&e)>>7;break;case 61440:this.Core.SetPrgRomPage8K(2,63&e);break;case 63488:63488===t&&(this.Core.N163_Address=e)}},r.prototype.Mapper19.prototype.CPUSync=function(t){0!==this.MAPPER_REG[3]&&(this.MAPPER_REG[4]+=t,this.MAPPER_REG[4]>=32767&&(this.MAPPER_REG[4]-=32767,this.SetIRQ()))},r.prototype.Mapper19.prototype.OutEXSound=function(t){return(t>>1)+(this.Core.Out_N163()>>1)},r.prototype.Mapper19.prototype.EXSoundSync=function(t){this.Core.Count_N163(t)},r.prototype.Mapper22=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(16)},r.prototype.Mapper22.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper22.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),0!==this.Core.ChrRomPageCount&&this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper22.prototype.Write=function(t,e){switch(61440&t){case 32768:0!==(2&this.MAPPER_REG[10])?this.Core.SetPrgRomPage8K(2,e):this.Core.SetPrgRomPage8K(0,e);break;case 40960:this.Core.SetPrgRomPage8K(1,e)}switch(61455&t){case 36864:e&=3,0===e?this.Core.SetMirror(!1):1===e?this.Core.SetMirror(!0):2===e?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1);break;case 36872:this.MAPPER_REG[10]=e;break;case 45056:this.MAPPER_REG[0]=240&this.MAPPER_REG[0]|15&e,this.Core.SetChrRomPage1K(0,this.MAPPER_REG[0]>>1);break;case 45058:case 45064:this.MAPPER_REG[0]=15&this.MAPPER_REG[0]|(15&e)<<4,this.Core.SetChrRomPage1K(0,this.MAPPER_REG[0]>>1);break;case 45057:case 45060:this.MAPPER_REG[1]=240&this.MAPPER_REG[1]|15&e,this.Core.SetChrRomPage1K(1,this.MAPPER_REG[1]>>1);break;case 45059:case 45068:this.MAPPER_REG[1]=15&this.MAPPER_REG[1]|(15&e)<<4,this.Core.SetChrRomPage1K(1,this.MAPPER_REG[1]>>1);break;case 49152:this.MAPPER_REG[2]=240&this.MAPPER_REG[2]|15&e,this.Core.SetChrRomPage1K(2,this.MAPPER_REG[2]>>1);break;case 49154:case 49160:this.MAPPER_REG[2]=15&this.MAPPER_REG[2]|(15&e)<<4,this.Core.SetChrRomPage1K(2,this.MAPPER_REG[2]>>1);break;case 49153:case 49156:this.MAPPER_REG[3]=240&this.MAPPER_REG[3]|15&e,this.Core.SetChrRomPage1K(3,this.MAPPER_REG[3]>>1);break;case 49155:case 49164:this.MAPPER_REG[3]=15&this.MAPPER_REG[3]|(15&e)<<4,this.Core.SetChrRomPage1K(3,this.MAPPER_REG[3]>>1);break;case 53248:this.MAPPER_REG[4]=240&this.MAPPER_REG[4]|15&e,this.Core.SetChrRomPage1K(4,this.MAPPER_REG[4]>>1);break;case 53250:case 53256:this.MAPPER_REG[4]=15&this.MAPPER_REG[4]|(15&e)<<4,this.Core.SetChrRomPage1K(4,this.MAPPER_REG[4]>>1);break;case 53249:case 53252:this.MAPPER_REG[5]=240&this.MAPPER_REG[5]|15&e,this.Core.SetChrRomPage1K(5,this.MAPPER_REG[5]>>1);break;case 53251:case 53260:this.MAPPER_REG[5]=15&this.MAPPER_REG[5]|(15&e)<<4,this.Core.SetChrRomPage1K(5,this.MAPPER_REG[5]>>1);break;case 57344:this.MAPPER_REG[6]=240&this.MAPPER_REG[6]|15&e,this.Core.SetChrRomPage1K(6,this.MAPPER_REG[6]>>1);break;case 57346:case 57352:this.MAPPER_REG[6]=15&this.MAPPER_REG[6]|(15&e)<<4,this.Core.SetChrRomPage1K(6,this.MAPPER_REG[6]>>1);break;case 57345:case 57348:this.MAPPER_REG[7]=240&this.MAPPER_REG[7]|15&e,this.Core.SetChrRomPage1K(7,this.MAPPER_REG[7]>>1);break;case 57347:case 57356:this.MAPPER_REG[7]=15&this.MAPPER_REG[7]|(15&e)<<4,this.Core.SetChrRomPage1K(7,this.MAPPER_REG[7]>>1)}},r.prototype.Mapper23=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(16)},r.prototype.Mapper23.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper23.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),0!==this.Core.ChrRomPageCount&&this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper23.prototype.Write=function(t,e){switch(61440&t){case 32768:0!==(2&this.MAPPER_REG[10])?this.Core.SetPrgRomPage8K(2,e):this.Core.SetPrgRomPage8K(0,e);break;case 40960:this.Core.SetPrgRomPage8K(1,e)}switch(61455&t){case 36864:e&=3,0===e?this.Core.SetMirror(!1):1===e?this.Core.SetMirror(!0):2===e?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1);break;case 36872:this.MAPPER_REG[10]=e;break;case 45056:this.MAPPER_REG[0]=240&this.MAPPER_REG[0]|15&e,this.Core.SetChrRomPage1K(0,this.MAPPER_REG[0]);break;case 45057:case 45060:this.MAPPER_REG[0]=15&this.MAPPER_REG[0]|(15&e)<<4,this.Core.SetChrRomPage1K(0,this.MAPPER_REG[0]);break;case 45058:case 45064:this.MAPPER_REG[1]=240&this.MAPPER_REG[1]|15&e,this.Core.SetChrRomPage1K(1,this.MAPPER_REG[1]);break;case 45059:case 45068:this.MAPPER_REG[1]=15&this.MAPPER_REG[1]|(15&e)<<4,this.Core.SetChrRomPage1K(1,this.MAPPER_REG[1]);break;case 49152:this.MAPPER_REG[2]=240&this.MAPPER_REG[2]|15&e,this.Core.SetChrRomPage1K(2,this.MAPPER_REG[2]);break;case 49153:case 49156:this.MAPPER_REG[2]=15&this.MAPPER_REG[2]|(15&e)<<4,this.Core.SetChrRomPage1K(2,this.MAPPER_REG[2]);break;case 49154:case 49160:this.MAPPER_REG[3]=240&this.MAPPER_REG[3]|15&e,this.Core.SetChrRomPage1K(3,this.MAPPER_REG[3]);break;case 49155:case 49164:this.MAPPER_REG[3]=15&this.MAPPER_REG[3]|(15&e)<<4,this.Core.SetChrRomPage1K(3,this.MAPPER_REG[3]);break;case 53248:this.MAPPER_REG[4]=240&this.MAPPER_REG[4]|15&e,this.Core.SetChrRomPage1K(4,this.MAPPER_REG[4]);break;case 53249:case 53252:this.MAPPER_REG[4]=15&this.MAPPER_REG[4]|(15&e)<<4,this.Core.SetChrRomPage1K(4,this.MAPPER_REG[4]);break;case 53250:case 53256:this.MAPPER_REG[5]=240&this.MAPPER_REG[5]|15&e,this.Core.SetChrRomPage1K(5,this.MAPPER_REG[5]);break;case 53251:case 53260:this.MAPPER_REG[5]=15&this.MAPPER_REG[5]|(15&e)<<4,this.Core.SetChrRomPage1K(5,this.MAPPER_REG[5]);break;case 57344:this.MAPPER_REG[6]=240&this.MAPPER_REG[6]|15&e,this.Core.SetChrRomPage1K(6,this.MAPPER_REG[6]);break;case 57345:case 57348:this.MAPPER_REG[6]=15&this.MAPPER_REG[6]|(15&e)<<4,this.Core.SetChrRomPage1K(6,this.MAPPER_REG[6]);break;case 57346:case 57352:this.MAPPER_REG[7]=240&this.MAPPER_REG[7]|15&e,this.Core.SetChrRomPage1K(7,this.MAPPER_REG[7]);break;case 57347:case 57356:this.MAPPER_REG[7]=15&this.MAPPER_REG[7]|(15&e)<<4,this.Core.SetChrRomPage1K(7,this.MAPPER_REG[7]);break;case 61440:this.MAPPER_REG[13]=240&this.MAPPER_REG[13]|15&e;break;case 61441:case 61444:this.MAPPER_REG[13]=15&this.MAPPER_REG[13]|(15&e)<<4;break;case 61442:case 61448:this.MAPPER_REG[11]=7&e,0!==(2&this.MAPPER_REG[11])&&(this.MAPPER_REG[12]=this.MAPPER_REG[13]);break;case 61443:case 61452:0!==(1&this.MAPPER_REG[11])?this.MAPPER_REG[11]|=2:this.MAPPER_REG[11]&=1,this.ClearIRQ()}},r.prototype.Mapper23.prototype.HSync=function(t){2===(6&this.MAPPER_REG[11])&&(255===this.MAPPER_REG[12]?(this.MAPPER_REG[12]=this.MAPPER_REG[13],this.SetIRQ()):this.MAPPER_REG[12]++)},r.prototype.Mapper23.prototype.CPUSync=function(t){6===(6&this.MAPPER_REG[11])&&(this.MAPPER_REG[12]>=255?(this.MAPPER_REG[12]=this.MAPPER_REG[13],this.SetIRQ()):this.MAPPER_REG[12]+=t)},r.prototype.Mapper24=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(3)},r.prototype.Mapper24.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper24.prototype.Init=function(){this.MAPPER_REG[0]=0,this.MAPPER_REG[1]=0,this.MAPPER_REG[2]=0,this.Core.SetPrgRomPages8K(0,1,2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper24.prototype.Write=function(t,e){switch(61443&t){case 32768:case 32769:case 32770:case 32771:this.Core.SetPrgRomPage8K(0,2*e),this.Core.SetPrgRomPage8K(1,2*e+1);break;case 36864:case 36865:case 36866:this.Core.Write_VRC6_REG(3&t,e);break;case 40960:case 40961:case 40962:this.Core.Write_VRC6_REG((3&t)+4,e);break;case 45056:case 45057:case 45058:this.Core.Write_VRC6_REG((3&t)+8,e);break;case 45059:e&=12,0===e?this.Core.SetMirror(!1):4===e?this.Core.SetMirror(!0):8===e?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1);break;case 49152:case 49153:case 49154:case 49155:this.Core.SetPrgRomPage8K(2,e);break;case 53248:case 53249:case 53250:case 53251:this.Core.SetChrRomPage1K(3&t,e);break;case 57344:case 57345:case 57346:case 57347:this.Core.SetChrRomPage1K((3&t)+4,e);break;case 61440:this.MAPPER_REG[0]=e;break;case 61441:this.MAPPER_REG[1]=7&e,0!==(2&this.MAPPER_REG[1])&&(this.MAPPER_REG[2]=this.MAPPER_REG[0]);break;case 61442:0!==(1&this.MAPPER_REG[1])?this.MAPPER_REG[1]|=2:this.MAPPER_REG[1]&=1,this.ClearIRQ()}},r.prototype.Mapper24.prototype.HSync=function(t){2===(6&this.MAPPER_REG[1])&&(255===this.MAPPER_REG[2]?(this.MAPPER_REG[2]=this.MAPPER_REG[0],this.SetIRQ()):this.MAPPER_REG[2]++)},r.prototype.Mapper24.prototype.CPUSync=function(t){6===(6&this.MAPPER_REG[1])&&(this.MAPPER_REG[2]>=255?(this.MAPPER_REG[2]=this.MAPPER_REG[0],this.SetIRQ()):this.MAPPER_REG[2]+=t)},r.prototype.Mapper24.prototype.OutEXSound=function(t){return(t>>1)+(this.Core.Out_VRC6()>>1)},r.prototype.Mapper24.prototype.EXSoundSync=function(t){this.Core.Count_VRC6(t)},r.prototype.Mapper25=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(16)},r.prototype.Mapper25.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper25.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),0!==this.Core.ChrRomPageCount&&this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7),this.MAPPER_REG[9]=2*this.Core.PrgRomPageCount-2},r.prototype.Mapper25.prototype.Write=function(t,e){switch(61440&t){case 32768:0!==(2&this.MAPPER_REG[10])?(this.MAPPER_REG[9]=e,this.Core.SetPrgRomPage8K(2,e)):(this.MAPPER_REG[8]=e,this.Core.SetPrgRomPage8K(0,e));break;case 40960:this.Core.SetPrgRomPage8K(1,e)}switch(61455&t){case 36864:e&=3,0===e?this.Core.SetMirror(!1):1===e?this.Core.SetMirror(!0):2===e?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1);break;case 36865:case 36868:if((2&this.MAPPER_REG[10])!==(2&e)){var s=this.MAPPER_REG[8];this.MAPPER_REG[8]=this.MAPPER_REG[9],this.MAPPER_REG[9]=s,this.Core.SetPrgRomPage8K(0,this.MAPPER_REG[8]),this.Core.SetPrgRomPage8K(2,this.MAPPER_REG[9])}this.MAPPER_REG[10]=e;break;case 45056:this.MAPPER_REG[0]=240&this.MAPPER_REG[0]|15&e,this.Core.SetChrRomPage1K(0,this.MAPPER_REG[0]);break;case 45057:case 45060:this.MAPPER_REG[1]=240&this.MAPPER_REG[1]|15&e,this.Core.SetChrRomPage1K(1,this.MAPPER_REG[1]);break;case 45058:case 45064:this.MAPPER_REG[0]=15&this.MAPPER_REG[0]|(15&e)<<4,this.Core.SetChrRomPage1K(0,this.MAPPER_REG[0]);break;case 45059:case 45068:this.MAPPER_REG[1]=15&this.MAPPER_REG[1]|(15&e)<<4,this.Core.SetChrRomPage1K(1,this.MAPPER_REG[1]);break;case 49152:this.MAPPER_REG[2]=240&this.MAPPER_REG[2]|15&e,this.Core.SetChrRomPage1K(2,this.MAPPER_REG[2]);break;case 49153:case 49156:this.MAPPER_REG[3]=240&this.MAPPER_REG[3]|15&e,this.Core.SetChrRomPage1K(3,this.MAPPER_REG[3]);break;case 49154:case 49160:this.MAPPER_REG[2]=15&this.MAPPER_REG[2]|(15&e)<<4,this.Core.SetChrRomPage1K(2,this.MAPPER_REG[2]);break;case 49155:case 49164:this.MAPPER_REG[3]=15&this.MAPPER_REG[3]|(15&e)<<4,this.Core.SetChrRomPage1K(3,this.MAPPER_REG[3]);break;case 53248:this.MAPPER_REG[4]=240&this.MAPPER_REG[4]|15&e,this.Core.SetChrRomPage1K(4,this.MAPPER_REG[4]);break;case 53249:case 53252:this.MAPPER_REG[5]=240&this.MAPPER_REG[5]|15&e,this.Core.SetChrRomPage1K(5,this.MAPPER_REG[5]);break;case 53250:case 53256:this.MAPPER_REG[4]=15&this.MAPPER_REG[4]|(15&e)<<4,this.Core.SetChrRomPage1K(4,this.MAPPER_REG[4]);break;case 53251:case 53260:this.MAPPER_REG[5]=15&this.MAPPER_REG[5]|(15&e)<<4,this.Core.SetChrRomPage1K(5,this.MAPPER_REG[5]);break;case 57344:this.MAPPER_REG[6]=240&this.MAPPER_REG[6]|15&e,this.Core.SetChrRomPage1K(6,this.MAPPER_REG[6]);break;case 57345:case 57348:this.MAPPER_REG[7]=240&this.MAPPER_REG[7]|15&e,this.Core.SetChrRomPage1K(7,this.MAPPER_REG[7]);break;case 57346:case 57352:this.MAPPER_REG[6]=15&this.MAPPER_REG[6]|(15&e)<<4,this.Core.SetChrRomPage1K(6,this.MAPPER_REG[6]);break;case 57347:case 57356:this.MAPPER_REG[7]=15&this.MAPPER_REG[7]|(15&e)<<4,this.Core.SetChrRomPage1K(7,this.MAPPER_REG[7]);break;case 61440:this.MAPPER_REG[13]=240&this.MAPPER_REG[13]|15&e;break;case 61441:case 61444:this.MAPPER_REG[11]=7&e,0!==(2&this.MAPPER_REG[11])&&(this.MAPPER_REG[12]=this.MAPPER_REG[13]);break;case 61442:case 61448:this.MAPPER_REG[13]=15&this.MAPPER_REG[13]|(15&e)<<4;break;case 61443:case 61452:0!==(1&this.MAPPER_REG[11])?this.MAPPER_REG[11]|=2:this.MAPPER_REG[11]&=1,this.ClearIRQ()}},r.prototype.Mapper25.prototype.HSync=function(t){2===(6&this.MAPPER_REG[11])&&(255===this.MAPPER_REG[12]?(this.MAPPER_REG[12]=this.MAPPER_REG[13],this.SetIRQ()):this.MAPPER_REG[12]++)},r.prototype.Mapper25.prototype.CPUSync=function(t){6===(6&this.MAPPER_REG[11])&&(this.MAPPER_REG[12]>=255?(this.MAPPER_REG[12]=this.MAPPER_REG[13],this.SetIRQ()):this.MAPPER_REG[12]+=t)},r.prototype.Mapper26=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(3)},r.prototype.Mapper26.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper26.prototype.Init=function(){this.MAPPER_REG[0]=0,this.MAPPER_REG[1]=0,this.MAPPER_REG[2]=0,this.Core.SetPrgRomPages8K(0,1,2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper26.prototype.Write=function(t,e){switch(t=65532&t|(2&t)>>1|(1&t)<<1,61443&t){case 32768:case 32769:case 32770:case 32771:this.Core.SetPrgRomPage8K(0,2*e),this.Core.SetPrgRomPage8K(1,2*e+1);break;case 36864:case 36865:case 36866:this.Core.Write_VRC6_REG(3&t,e);break;case 40960:case 40961:case 40962:this.Core.Write_VRC6_REG((3&t)+4,e);break;case 45056:case 45057:case 45058:this.Core.Write_VRC6_REG((3&t)+8,e);break;case 45059:e&=12,0===e?this.Core.SetMirror(!1):4===e?this.Core.SetMirror(!0):8===e?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1);break;case 49152:case 49153:case 49154:case 49155:this.Core.SetPrgRomPage8K(2,e);break;case 53248:case 53249:case 53250:case 53251:this.Core.SetChrRomPage1K(3&t,e);break;case 57344:case 57345:case 57346:case 57347:this.Core.SetChrRomPage1K((3&t)+4,e);break;case 61440:this.MAPPER_REG[0]=e;break;case 61441:this.MAPPER_REG[1]=7&e,0!==(2&this.MAPPER_REG[1])&&(this.MAPPER_REG[2]=this.MAPPER_REG[0]),this.ClearIRQ();break;case 61442:0!==(1&this.MAPPER_REG[1])?this.MAPPER_REG[1]|=2:this.MAPPER_REG[1]&=1}},r.prototype.Mapper26.prototype.HSync=function(t){2===(6&this.MAPPER_REG[1])&&(255===this.MAPPER_REG[2]?(this.MAPPER_REG[2]=this.MAPPER_REG[0],this.SetIRQ()):this.MAPPER_REG[2]++)},r.prototype.Mapper26.prototype.CPUSync=function(t){6===(6&this.MAPPER_REG[1])&&(this.MAPPER_REG[2]>=255?(this.MAPPER_REG[2]=this.MAPPER_REG[0],this.SetIRQ()):this.MAPPER_REG[2]+=t)},r.prototype.Mapper26.prototype.OutEXSound=function(t){return(t>>1)+(this.Core.Out_VRC6()>>1)},r.prototype.Mapper26.prototype.EXSoundSync=function(t){this.Core.Count_VRC6(t)},r.prototype.Mapper32=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(11)},r.prototype.Mapper32.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper32.prototype.Init=function(){for(var t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper32.prototype.Write=function(t,e){switch(61440&t){case 32768:this.MAPPER_REG[8]=e,0===(2&this.MAPPER_REG[10])?this.Core.SetPrgRomPage8K(0,e):this.Core.SetPrgRomPage8K(2,e);break;case 36864:this.MAPPER_REG[10]=e,0===(1&e)?this.Core.SetMirror(!1):this.Core.SetMirror(!0),0===(2&e)?(this.Core.SetPrgRomPage8K(0,this.MAPPER_REG[8]),this.Core.SetPrgRomPage8K(2,2*(this.Core.PrgRomPageCount-1))):(this.Core.SetPrgRomPage8K(0,0),this.Core.SetPrgRomPage8K(2,this.MAPPER_REG[8]));break;case 40960:this.MAPPER_REG[9]=e,this.Core.SetPrgRomPage8K(1,e);break;case 45056:var s=7&t;this.MAPPER_REG[s]=e,this.Core.SetChrRomPage1K(s,e)}},r.prototype.Mapper33=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper33.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper33.prototype.Init=function(){this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper33.prototype.Write=function(t,e){switch(40963&t){case 32768:this.Core.SetPrgRomPage8K(0,63&e),0===(64&e)?this.Core.SetMirror(!1):this.Core.SetMirror(!0);break;case 32769:this.Core.SetPrgRomPage8K(1,63&e);break;case 32770:this.Core.SetChrRomPage1K(0,e<<1),this.Core.SetChrRomPage1K(1,(e<<1)+1);break;case 32771:this.Core.SetChrRomPage1K(2,e<<1),this.Core.SetChrRomPage1K(3,(e<<1)+1);break;case 40960:this.Core.SetChrRomPage1K(4,e);break;case 40961:this.Core.SetChrRomPage1K(5,e);break;case 40962:this.Core.SetChrRomPage1K(6,e);break;case 40963:this.Core.SetChrRomPage1K(7,e)}},r.prototype.Mapper34=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper34.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper34.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,1),this.Core.SetChrRomPage(0)},r.prototype.Mapper34.prototype.Write=function(t,e){var s=(3&e)<<1;this.Core.SetPrgRomPage(0,s),this.Core.SetPrgRomPage(1,s+1)},r.prototype.Mapper48=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(3)},r.prototype.Mapper48.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper48.prototype.Init=function(){for(var t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper48.prototype.Write=function(t,e){switch(57347&t){case 32768:this.Core.SetPrgRomPage8K(0,e);break;case 32769:this.Core.SetPrgRomPage8K(1,e);break;case 32770:this.Core.SetChrRomPage1K(0,e<<1),this.Core.SetChrRomPage1K(1,(e<<1)+1);break;case 32771:this.Core.SetChrRomPage1K(2,e<<1),this.Core.SetChrRomPage1K(3,(e<<1)+1);break;case 40960:this.Core.SetChrRomPage1K(4,e);break;case 40961:this.Core.SetChrRomPage1K(5,e);break;case 40962:this.Core.SetChrRomPage1K(6,e);break;case 40963:this.Core.SetChrRomPage1K(7,e);break;case 49152:this.MAPPER_REG[1]=e,this.MAPPER_REG[0]=0,this.ClearIRQ();break;case 49153:this.MAPPER_REG[1]=e,this.MAPPER_REG[0]=1;break;case 57344:0===(64&e)?this.Core.SetMirror(!1):this.Core.SetMirror(!0)}},r.prototype.Mapper48.prototype.HSync=function(t){1===this.MAPPER_REG[0]&&240>t&&8===(8&this.Core.IO1[1])&&(255===this.MAPPER_REG[1]&&(this.SetIRQ(),this.MAPPER_REG[0]=0),this.MAPPER_REG[1]++)},r.prototype.Mapper65=function(t){r.prototype.MapperProto.apply(this,arguments),this.IRQ_Counter=0,this.IRQ_Value=0,this.IRQ_Flag=!1},r.prototype.Mapper65.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper65.prototype.Init=function(){this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7),this.IRQ_Counter=0},r.prototype.Mapper65.prototype.Write=function(t,e){switch(61440&t){case 32768:this.Core.SetPrgRomPage8K(0,e);break;case 36864:switch(t){case 36865:0===(128&e)?this.Core.SetMirror(!1):this.Core.SetMirror(!0);break;case 36867:this.IRQ_Flag=128===(128&e),this.ClearIRQ();break;case 36868:this.IRQ_Counter=this.IRQ_Value,this.IRQ_Flag=!0,this.ClearIRQ();break;case 36869:this.IRQ_Value=e<<8|255&this.IRQ_Value;break;case 36870:this.IRQ_Value=65280&this.IRQ_Value|e}break;case 40960:this.Core.SetPrgRomPage8K(1,e);break;case 45056:case 45057:case 45058:case 45059:case 45060:case 45061:case 45062:case 45063:this.Core.SetChrRomPage1K(7&t,e);break;case 49152:this.Core.SetPrgRomPage8K(2,e)}},r.prototype.Mapper65.prototype.CPUSync=function(t){this.IRQ_Flag&&0!==this.IRQ_Counter&&(this.IRQ_Counter-=t,this.IRQ_Counter<=0&&(this.IRQ_Counter=0,this.IRQ_Flag=!1,this.SetIRQ()))},r.prototype.Mapper66=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper66.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper66.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,1),this.Core.SetChrRomPage(0)},r.prototype.Mapper66.prototype.Write=function(t,e){var s=(48&e)>>3;this.Core.SetPrgRomPage(0,s),this.Core.SetPrgRomPage(1,s+1),this.Core.SetChrRomPage(3&e)},r.prototype.Mapper67=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(8),this.IRQ_Toggle=0},r.prototype.Mapper67.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper67.prototype.Init=function(){for(var t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,8*this.Core.ChrRomPageCount-4,8*this.Core.ChrRomPageCount-3,8*this.Core.ChrRomPageCount-2,8*this.Core.ChrRomPageCount-1),this.IRQ_Toggle=0},r.prototype.Mapper67.prototype.Write=function(t,e){switch(63488&t){case 34816:this.MAPPER_REG[0]=e,this.Core.SetChrRomPage1K(0,e<<1),this.Core.SetChrRomPage1K(1,(e<<1)+1);break;case 38912:this.MAPPER_REG[1]=e,this.Core.SetChrRomPage1K(2,e<<1),this.Core.SetChrRomPage1K(3,(e<<1)+1);break;case 43008:this.MAPPER_REG[2]=e,this.Core.SetChrRomPage1K(4,e<<1),this.Core.SetChrRomPage1K(5,(e<<1)+1);break;case 47104:this.MAPPER_REG[3]=e,this.Core.SetChrRomPage1K(6,e<<1),this.Core.SetChrRomPage1K(7,(e<<1)+1);break;case 51200:0===this.IRQ_Toggle?this.MAPPER_REG[4]=255&this.MAPPER_REG[4]|e<<8:this.MAPPER_REG[4]=65280&this.MAPPER_REG[4]|e,this.IRQ_Toggle^=1;break;case 55296:this.MAPPER_REG[5]=e,this.IRQ_Toggle=0,this.ClearIRQ();break;case 59392:this.MAPPER_REG[6]=e,e&=3,0===e?this.Core.SetMirror(!1):1===e?this.Core.SetMirror(!0):2===e?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1);break;case 63488:this.MAPPER_REG[7]=e,this.Core.SetPrgRomPage8K(0,e<<1),this.Core.SetPrgRomPage8K(1,(e<<1)+1)}},r.prototype.Mapper67.prototype.CPUSync=function(t){16===(16&this.MAPPER_REG[5])&&(this.MAPPER_REG[4]-=t,this.MAPPER_REG[4]<0&&(this.MAPPER_REG[4]=65535,this.MAPPER_REG[5]&=239,this.SetIRQ()))},r.prototype.Mapper68=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(8)},r.prototype.Mapper68.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper68.prototype.Init=function(){for(var t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper68.prototype.Write=function(t,e){switch(61440&t){case 32768:this.MAPPER_REG[0]=e,this.Core.SetChrRomPage1K(0,e<<1),this.Core.SetChrRomPage1K(1,(e<<1)+1);break;case 36864:this.MAPPER_REG[1]=e,this.Core.SetChrRomPage1K(2,e<<1),this.Core.SetChrRomPage1K(3,(e<<1)+1);break;case 40960:this.MAPPER_REG[2]=e,this.Core.SetChrRomPage1K(4,e<<1),this.Core.SetChrRomPage1K(5,(e<<1)+1);break;case 45056:this.MAPPER_REG[3]=e,this.Core.SetChrRomPage1K(6,e<<1),this.Core.SetChrRomPage1K(7,(e<<1)+1);break;case 49152:this.MAPPER_REG[4]=e,this.SetMirror();break;case 53248:this.MAPPER_REG[5]=e,this.SetMirror();break;case 57344:this.MAPPER_REG[6]=e,this.SetMirror();break;case 61440:this.MAPPER_REG[7]=e,this.Core.SetPrgRomPage8K(0,e<<1),this.Core.SetPrgRomPage8K(1,(e<<1)+1)}},r.prototype.Mapper68.prototype.SetMirror=function(){switch(17&this.MAPPER_REG[6]){case 0:this.Core.SetMirror(!1);break;case 1:this.Core.SetMirror(!0);break;case 16:this.Core.SetChrRomPage1K(8,128|this.MAPPER_REG[4]),this.Core.SetChrRomPage1K(9,128|this.MAPPER_REG[5]),this.Core.SetChrRomPage1K(10,128|this.MAPPER_REG[4]),this.Core.SetChrRomPage1K(11,128|this.MAPPER_REG[5]);break;case 17:this.Core.SetChrRomPage1K(8,128|this.MAPPER_REG[4]),this.Core.SetChrRomPage1K(9,128|this.MAPPER_REG[4]),this.Core.SetChrRomPage1K(10,128|this.MAPPER_REG[5]),this.Core.SetChrRomPage1K(11,128|this.MAPPER_REG[5])}},r.prototype.Mapper69=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(16),this.MAPPER_REG_Select=0,this.R8_ROM=null,this.IRQ_Counter=0},r.prototype.Mapper69.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper69.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.Core.SetPrgRomPages8K(0,1,2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper69.prototype.Write=function(t,e){switch(57344&t){case 32768:this.MAPPER_REG_Select=e;break;case 40960:switch(this.MAPPER_REG[this.MAPPER_REG_Select]=e,this.MAPPER_REG_Select){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:this.Core.SetChrRomPage1K(this.MAPPER_REG_Select,e);break;case 8:this.R8_ROM=this.Core.PRGROM_PAGES[(63&e)%(2*this.Core.PrgRomPageCount)];break;case 9:this.Core.SetPrgRomPage8K(0,e);break;case 10:this.Core.SetPrgRomPage8K(1,e);break;case 11:this.Core.SetPrgRomPage8K(2,e);break;case 12:e&=3,0===e?this.Core.SetMirror(!1):1===e?this.Core.SetMirror(!0):2===e?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1);break;case 13:0===(1&e)&&this.ClearIRQ();break;case 14:this.IRQ_Counter=65280&this.IRQ_Counter|e;break;case 15:this.IRQ_Counter=255&this.IRQ_Counter|e<<8}break;case 49152:this.Core.Select_AY_REG(e);break;case 57344:this.Core.Write_AY_REG(e)}},r.prototype.Mapper69.prototype.ReadSRAM=function(t){return 0===(64&this.MAPPER_REG[8])?this.R8_ROM[8191&t]:this.Core.SRAM[8191&t]},r.prototype.Mapper69.prototype.WriteSRAM=function(t,e){64===(64&this.MAPPER_REG[8])&&(this.Core.SRAM[8191&t]=e)},r.prototype.Mapper69.prototype.CPUSync=function(t){128===(128&this.MAPPER_REG[13])&&(this.IRQ_Counter-=t,this.IRQ_Counter<0&&(this.IRQ_Counter=65535,1===(1&this.MAPPER_REG[13])&&this.SetIRQ()))},r.prototype.Mapper69.prototype.OutEXSound=function(t){return(t>>1)+(this.Core.Out_AY()>>1)},r.prototype.Mapper69.prototype.EXSoundSync=function(t){this.Core.Count_AY(t)},r.prototype.Mapper70=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper70.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper70.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,this.Core.PrgRomPageCount-1),this.Core.SetChrRomPage(0)},r.prototype.Mapper70.prototype.Write=function(t,e){this.Core.SetPrgRomPage(0,(112&e)>>4),this.Core.SetChrRomPage(15&e),0===(128&e)?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1)},r.prototype.Mapper72=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(1)},r.prototype.Mapper72.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper72.prototype.Init=function(){this.MAPPER_REG[0]=0,this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper72.prototype.Write=function(t,e){var s;0===(192&this.MAPPER_REG[0])&&(128===(128&e)&&(s=2*(7&e),this.Core.SetPrgRomPage8K(0,s),this.Core.SetPrgRomPage8K(1,s+1)),64===(64&e)&&(s=8*(15&e),this.Core.SetChrRomPages1K(s,s+1,s+2,s+3,s+4,s+5,s+6,s+7))),this.MAPPER_REG[0]=e},r.prototype.Mapper73=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(3)},r.prototype.Mapper73.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper73.prototype.Init=function(){this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.MAPPER_REG[0]=0,this.MAPPER_REG[1]=0,this.MAPPER_REG[2]=0},r.prototype.Mapper73.prototype.Write=function(t,e){switch(t){case 32768:this.MAPPER_REG[0]=65520&this.MAPPER_REG[0]|15&e,this.MAPPER_REG[2]=this.MAPPER_REG[0];break;case 36864:this.MAPPER_REG[0]=65295&this.MAPPER_REG[0]|(15&e)<<4,this.MAPPER_REG[2]=this.MAPPER_REG[0];break;case 40960:this.MAPPER_REG[0]=61695&this.MAPPER_REG[0]|(15&e)<<8,
this.MAPPER_REG[2]=this.MAPPER_REG[0];break;case 45056:this.MAPPER_REG[0]=4095&this.MAPPER_REG[0]|(15&e)<<12,this.MAPPER_REG[2]=this.MAPPER_REG[0];break;case 49152:this.MAPPER_REG[1]=7&e,0!==(2&this.MAPPER_REG[1])&&(this.MAPPER_REG[2]=this.MAPPER_REG[0]);break;case 53248:0!==(1&this.MAPPER_REG[1])?this.MAPPER_REG[1]|=2:this.MAPPER_REG[1]&=1,this.ClearIRQ();break;case 61440:this.Core.SetPrgRomPage8K(0,2*e),this.Core.SetPrgRomPage8K(1,2*e+1)}},r.prototype.Mapper73.prototype.CPUSync=function(t){0!==(2&this.MAPPER_REG[1])&&(0!==(4&this.MAPPER_REG[1])?(this.MAPPER_REG[2]+=t,this.MAPPER_REG[2]>255&&(this.MAPPER_REG[2]=this.MAPPER_REG[0],this.SetIRQ())):(this.MAPPER_REG[2]+=t,this.MAPPER_REG[2]>65535&&(this.MAPPER_REG[2]=this.MAPPER_REG[0],this.SetIRQ())))},r.prototype.Mapper75=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(1)},r.prototype.Mapper75.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper75.prototype.Init=function(){this.Core.SetPrgRomPages8K(0,0,0,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,0,0,0,0,0,0,0),this.MAPPER_REG[0]=0},r.prototype.Mapper75.prototype.Write=function(t,e){var s;switch(t){case 32768:this.Core.SetPrgRomPage8K(0,15&e);break;case 36864:this.MAPPER_REG[0]=e,0===(1&e)?this.Core.SetMirror(!1):this.Core.SetMirror(!0);break;case 40960:this.Core.SetPrgRomPage8K(1,15&e);break;case 49152:this.Core.SetPrgRomPage8K(2,15&e);break;case 57344:s=((2&this.MAPPER_REG[0])<<3|15&e)<<2,this.Core.SetChrRomPage1K(0,s),this.Core.SetChrRomPage1K(1,s+1),this.Core.SetChrRomPage1K(2,s+2),this.Core.SetChrRomPage1K(3,s+3);break;case 61440:s=((4&this.MAPPER_REG[0])<<2|15&e)<<2,this.Core.SetChrRomPage1K(4,s),this.Core.SetChrRomPage1K(5,s+1),this.Core.SetChrRomPage1K(6,s+2),this.Core.SetChrRomPage1K(7,s+3)}},r.prototype.Mapper76=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(1)},r.prototype.Mapper76.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper76.prototype.Init=function(){this.Core.SetPrgRomPages8K(0,0,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,0,0,0,0,0,0,0),this.MAPPER_REG[0]=0},r.prototype.Mapper76.prototype.Write=function(t,e){if(32768===t&&(this.MAPPER_REG[0]=7&e),32769===t)switch(this.MAPPER_REG[0]){case 2:this.Core.SetChrRomPage1K(0,2*(63&e)),this.Core.SetChrRomPage1K(1,2*(63&e)+1);break;case 3:this.Core.SetChrRomPage1K(2,2*(63&e)),this.Core.SetChrRomPage1K(3,2*(63&e)+1);break;case 4:this.Core.SetChrRomPage1K(4,2*(63&e)),this.Core.SetChrRomPage1K(5,2*(63&e)+1);break;case 5:this.Core.SetChrRomPage1K(6,2*(63&e)),this.Core.SetChrRomPage1K(7,2*(63&e)+1);break;case 6:this.Core.SetPrgRomPage8K(0,15&e);break;case 7:this.Core.SetPrgRomPage8K(1,15&e)}},r.prototype.Mapper77=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper77.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper77.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,1),this.Core.SetChrRomPage1K(0,0),this.Core.SetChrRomPage1K(1,1),this.Core.SetChrRomPage1K(2,258),this.Core.SetChrRomPage1K(3,259),this.Core.SetChrRomPage1K(4,260),this.Core.SetChrRomPage1K(5,261),this.Core.SetChrRomPage1K(6,262),this.Core.SetChrRomPage1K(7,263)},r.prototype.Mapper77.prototype.Write=function(t,e){var s=(15&e)<<1;this.Core.SetPrgRomPage(0,s),this.Core.SetPrgRomPage(1,s+1),s=(240&e)>>3,this.Core.SetChrRomPage1K(0,s),this.Core.SetChrRomPage1K(1,s+1)},r.prototype.Mapper78=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper78.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper78.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,this.Core.PrgRomPageCount-1),this.Core.SetChrRomPage(0)},r.prototype.Mapper78.prototype.Write=function(t,e){this.Core.SetPrgRomPage(0,7&e),this.Core.SetChrRomPage(e>>4),8===(8&e)?this.Core.SetMirror(!1):this.Core.SetMirror(!0)},r.prototype.Mapper80=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(11),this.EX_RAM=new Array(128)},r.prototype.Mapper80.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper80.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;for(t=0;t<this.EX_RAM.length;t++)this.EX_RAM[t]=0;this.Core.SetPrgRomPages8K(0,1,2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper80.prototype.ReadSRAM=function(t){if(t>=32512&&32767>=t)return this.EX_RAM[127&t];switch(t){case 32496:return this.MAPPER_REG[0];case 32497:return this.MAPPER_REG[1];case 32498:return this.MAPPER_REG[2];case 32499:return this.MAPPER_REG[3];case 32500:return this.MAPPER_REG[4];case 32501:return this.MAPPER_REG[5];case 32502:case 32503:return this.MAPPER_REG[6];case 32504:case 32505:return this.MAPPER_REG[7];case 32506:case 32507:return this.MAPPER_REG[8];case 32508:case 32509:return this.MAPPER_REG[9];case 32510:case 32511:return this.MAPPER_REG[10]}return 0},r.prototype.Mapper80.prototype.WriteSRAM=function(t,e){if(t>=32512&&32767>=t)return void(this.EX_RAM[127&t]=e);switch(t){case 32496:this.MAPPER_REG[0]=e,this.Core.SetChrRomPage1K(0,254&e),this.Core.SetChrRomPage1K(1,(254&e)+1);break;case 32497:this.MAPPER_REG[1]=e,this.Core.SetChrRomPage1K(2,254&e),this.Core.SetChrRomPage1K(3,(254&e)+1);break;case 32498:this.MAPPER_REG[2]=e,this.Core.SetChrRomPage1K(4,e);break;case 32499:this.MAPPER_REG[3]=e,this.Core.SetChrRomPage1K(5,e);break;case 32500:this.MAPPER_REG[4]=e,this.Core.SetChrRomPage1K(6,e);break;case 32501:this.MAPPER_REG[5]=e,this.Core.SetChrRomPage1K(7,e);break;case 32502:case 32503:this.MAPPER_REG[6]=e,1===(1&e)?this.Core.SetMirror(!1):this.Core.SetMirror(!0);break;case 32504:case 32505:this.MAPPER_REG[7]=e;break;case 32506:case 32507:this.MAPPER_REG[8]=e,this.Core.SetPrgRomPage8K(0,e);break;case 32508:case 32509:this.MAPPER_REG[9]=e,this.Core.SetPrgRomPage8K(1,e);break;case 32510:case 32511:this.MAPPER_REG[10]=e,this.Core.SetPrgRomPage8K(2,e)}},r.prototype.Mapper82=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(13),this.EX_RAM=new Array(5120)},r.prototype.Mapper82.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper82.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;for(t=0;t<this.EX_RAM.length;t++)this.EX_RAM[t]=0;this.Core.SetPrgRomPages8K(0,1,2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper82.prototype.ReadSRAM=function(t){return t>=24576&&29695>=t?this.EX_RAM[t-24576]:t>=32496&&32508>=t?this.MAPPER_REG[t-32496]:void 0},r.prototype.Mapper82.prototype.WriteSRAM=function(t,e){if(t>=24576&&29695>=t)return void(this.EX_RAM[t-24576]=e);switch(t){case 32496:this.MAPPER_REG[0]=e,this.SetChr();break;case 32497:this.MAPPER_REG[1]=e,this.SetChr();break;case 32498:this.MAPPER_REG[2]=e,this.SetChr();break;case 32499:this.MAPPER_REG[3]=e,this.SetChr();break;case 32500:this.MAPPER_REG[4]=e,this.SetChr();break;case 32501:this.MAPPER_REG[5]=e,this.SetChr();break;case 32502:this.MAPPER_REG[6]=e,this.SetChr(),1===(1&e)?this.Core.SetMirror(!1):this.Core.SetMirror(!0);break;case 32503:this.MAPPER_REG[7]=e;break;case 32504:this.MAPPER_REG[8]=e;break;case 32505:this.MAPPER_REG[9]=e;break;case 32506:this.MAPPER_REG[10]=e,this.Core.SetPrgRomPage8K(0,e>>>2);break;case 32507:this.MAPPER_REG[11]=e,this.Core.SetPrgRomPage8K(1,e>>>2);break;case 32508:this.MAPPER_REG[12]=e,this.Core.SetPrgRomPage8K(2,e>>>2)}},r.prototype.Mapper82.prototype.SetChr=function(){0===(2&this.MAPPER_REG[6])?(this.Core.SetChrRomPage1K(0,254&this.MAPPER_REG[0]),this.Core.SetChrRomPage1K(1,(254&this.MAPPER_REG[0])+1),this.Core.SetChrRomPage1K(2,254&this.MAPPER_REG[1]),this.Core.SetChrRomPage1K(3,(254&this.MAPPER_REG[1])+1),this.Core.SetChrRomPage1K(4,this.MAPPER_REG[2]),this.Core.SetChrRomPage1K(5,this.MAPPER_REG[3]),this.Core.SetChrRomPage1K(6,this.MAPPER_REG[4]),this.Core.SetChrRomPage1K(7,this.MAPPER_REG[5])):(this.Core.SetChrRomPage1K(4,254&this.MAPPER_REG[0]),this.Core.SetChrRomPage1K(5,(254&this.MAPPER_REG[0])+1),this.Core.SetChrRomPage1K(6,254&this.MAPPER_REG[1]),this.Core.SetChrRomPage1K(7,(254&this.MAPPER_REG[1])+1),this.Core.SetChrRomPage1K(0,this.MAPPER_REG[2]),this.Core.SetChrRomPage1K(1,this.MAPPER_REG[3]),this.Core.SetChrRomPage1K(2,this.MAPPER_REG[4]),this.Core.SetChrRomPage1K(3,this.MAPPER_REG[5]))},r.prototype.Mapper85=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(15),this.MAPPER_EXVRAM=new Array(8)},r.prototype.Mapper85.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper85.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;for(t=0;t<this.MAPPER_EXVRAM.length;t++){this.MAPPER_EXVRAM[t]=new Array(1024);for(var e=0;e<this.MAPPER_EXVRAM[t].length;e++)this.MAPPER_EXVRAM[t][e]=0}this.Core.SetPrgRomPages8K(0,1,2,2*this.Core.PrgRomPageCount-1),0===this.Core.ChrRomPageCount?(this.Core.VRAM[0]=this.MAPPER_EXVRAM[0],this.Core.VRAM[1]=this.MAPPER_EXVRAM[0],this.Core.VRAM[2]=this.MAPPER_EXVRAM[0],this.Core.VRAM[3]=this.MAPPER_EXVRAM[0],this.Core.VRAM[4]=this.MAPPER_EXVRAM[0],this.Core.VRAM[5]=this.MAPPER_EXVRAM[0],this.Core.VRAM[6]=this.MAPPER_EXVRAM[0],this.Core.VRAM[7]=this.MAPPER_EXVRAM[0]):this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper85.prototype.Write=function(t,e){switch(61496&t){case 32768:this.MAPPER_REG[0]=e,this.Core.SetPrgRomPage8K(0,e);break;case 32776:case 32784:this.MAPPER_REG[1]=e,this.Core.SetPrgRomPage8K(1,e);break;case 36864:this.MAPPER_REG[2]=e,this.Core.SetPrgRomPage8K(2,e);break;case 40960:this.MAPPER_REG[3]=e,0===this.Core.ChrRomPageCount?this.Core.VRAM[0]=this.MAPPER_EXVRAM[e]:this.Core.SetChrRomPage1K(0,e);break;case 40968:case 40976:this.MAPPER_REG[4]=e,0===this.Core.ChrRomPageCount?this.Core.VRAM[1]=this.MAPPER_EXVRAM[e]:this.Core.SetChrRomPage1K(1,e);break;case 45056:this.MAPPER_REG[5]=e,0===this.Core.ChrRomPageCount?this.Core.VRAM[2]=this.MAPPER_EXVRAM[e]:this.Core.SetChrRomPage1K(2,e);break;case 45064:case 45072:this.MAPPER_REG[6]=e,0===this.Core.ChrRomPageCount?this.Core.VRAM[3]=this.MAPPER_EXVRAM[e]:this.Core.SetChrRomPage1K(3,e);break;case 49152:this.MAPPER_REG[7]=e,0===this.Core.ChrRomPageCount?this.Core.VRAM[4]=this.MAPPER_EXVRAM[e]:this.Core.SetChrRomPage1K(4,e);break;case 49160:case 49168:this.MAPPER_REG[8]=e,0===this.Core.ChrRomPageCount?this.Core.VRAM[5]=this.MAPPER_EXVRAM[e]:this.Core.SetChrRomPage1K(5,e);break;case 53248:this.MAPPER_REG[9]=e,0===this.Core.ChrRomPageCount?this.Core.VRAM[6]=this.MAPPER_EXVRAM[e]:this.Core.SetChrRomPage1K(6,e);break;case 53256:case 53264:this.MAPPER_REG[10]=e,0===this.Core.ChrRomPageCount?this.Core.VRAM[7]=this.MAPPER_EXVRAM[e]:this.Core.SetChrRomPage1K(7,e);break;case 57344:this.MAPPER_REG[14]=e,e&=3,0===e?this.Core.SetMirror(!1):1===e?this.Core.SetMirror(!0):2===e?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1);break;case 57352:case 57360:this.MAPPER_REG[13]=e;break;case 61440:this.MAPPER_REG[11]=7&e,0!==(2&this.MAPPER_REG[11])&&(this.MAPPER_REG[12]=this.MAPPER_REG[13]);break;case 61448:case 61456:0!==(1&this.MAPPER_REG[11])?this.MAPPER_REG[11]|=2:this.MAPPER_REG[11]&=1,this.ClearIRQ()}},r.prototype.Mapper85.prototype.HSync=function(t){2===(6&this.MAPPER_REG[11])&&(255===this.MAPPER_REG[12]?(this.MAPPER_REG[12]=this.MAPPER_REG[13],this.SetIRQ()):this.MAPPER_REG[12]++)},r.prototype.Mapper85.prototype.CPUSync=function(t){6===(6&this.MAPPER_REG[11])&&(this.MAPPER_REG[12]>=255?(this.MAPPER_REG[12]=this.MAPPER_REG[13],this.SetIRQ()):this.MAPPER_REG[12]+=t)},r.prototype.Mapper86=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper86.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper86.prototype.Init=function(){this.Core.SetPrgRomPages8K(2*this.Core.PrgRomPageCount-4,2*this.Core.PrgRomPageCount-3,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper86.prototype.WriteSRAM=function(t,e){if(t>=24576&&28671>t){var s=(48&e)>>>4<<2,r=((64&e)>>>4|3&e)<<3;this.Core.SetPrgRomPages8K(s,s+1,s+2,s+3),this.Core.SetChrRomPages1K(r,r+1,r+2,r+3,r+4,r+5,r+6,r+7)}},r.prototype.Mapper87=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper87.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper87.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,this.Core.PrgRomPageCount-1),this.Core.SetChrRomPage(0)},r.prototype.Mapper87.prototype.WriteSRAM=function(t,e){var s=(2&e)>>>1|(1&e)<<1;this.Core.SetChrRomPage(s)},r.prototype.Mapper88=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(1)},r.prototype.Mapper88.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper88.prototype.Init=function(){this.Core.SetPrgRomPages8K(0,0,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,0,0,0,0,0,0,0),this.MAPPER_REG[0]=0},r.prototype.Mapper88.prototype.Write=function(t,e){if(32768===t&&(this.MAPPER_REG[0]=7&e),32769===t)switch(this.MAPPER_REG[0]){case 0:this.Core.SetChrRomPage1K(0,62&e),this.Core.SetChrRomPage1K(1,(62&e)+1);break;case 1:this.Core.SetChrRomPage1K(2,62&e),this.Core.SetChrRomPage1K(3,(62&e)+1);break;case 2:this.Core.SetChrRomPage1K(4,63&e|64);break;case 3:this.Core.SetChrRomPage1K(5,63&e|64);break;case 4:this.Core.SetChrRomPage1K(6,63&e|64);break;case 5:this.Core.SetChrRomPage1K(7,63&e|64);break;case 6:this.Core.SetPrgRomPage8K(0,15&e);break;case 7:this.Core.SetPrgRomPage8K(1,15&e)}},r.prototype.Mapper89=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper89.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper89.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,this.Core.PrgRomPageCount-1),this.Core.SetChrRomPage(0)},r.prototype.Mapper89.prototype.Write=function(t,e){this.Core.SetPrgRomPage(0,(112&e)>>4),this.Core.SetChrRomPage((128&e)>>4|7&e),0===(8&e)?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1)},r.prototype.Mapper92=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper92.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper92.prototype.Init=function(){this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper92.prototype.Write=function(t,e){var s=(15&t)<<1,r=(15&t)<<3;t>=36864?208===(240&t)?this.Core.SetPrgRomPages8K(0,1,s,s+1):224===(240&t)&&this.Core.SetChrRomPages1K(r,r+1,r+2,r+3,r+4,r+5,r+6,r+7):176===(240&t)?this.Core.SetPrgRomPages8K(0,1,s,s+1):112===(240&t)&&this.Core.SetChrRomPages1K(r,r+1,r+2,r+3,r+4,r+5,r+6,r+7)},r.prototype.Mapper93=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper93.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper93.prototype.Init=function(){this.Core.SetPrgRomPages8K(0,1,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper93.prototype.WriteSRAM=function(t,e){24576===t&&(this.Core.SetPrgRomPage8K(0,2*e),this.Core.SetPrgRomPage8K(1,2*e+1))},r.prototype.Mapper94=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper94.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper94.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,this.Core.PrgRomPageCount-1),this.Core.SetChrRomPage(0)},r.prototype.Mapper94.prototype.Write=function(t,e){this.Core.SetPrgRomPage(0,e>>2)},r.prototype.Mapper95=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(1)},r.prototype.Mapper95.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper95.prototype.Init=function(){this.Core.SetPrgRomPages8K(0,0,2*this.Core.PrgRomPageCount-2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,0,0,0,0,0,0,0),this.MAPPER_REG[0]=0},r.prototype.Mapper95.prototype.Write=function(t,e){if(0===(1&t)&&(this.MAPPER_REG[0]=7&e),1===(1&t))switch(this.MAPPER_REG[0]<=5&&(32===(32&e)?this.Core.SetMirrors(1,1,1,1):this.Core.SetMirrors(0,0,0,0)),this.MAPPER_REG[0]){case 0:this.Core.SetChrRomPage1K(0,30&e),this.Core.SetChrRomPage1K(1,(30&e)+1);break;case 1:this.Core.SetChrRomPage1K(2,30&e),this.Core.SetChrRomPage1K(3,(30&e)+1);break;case 2:this.Core.SetChrRomPage1K(4,31&e);break;case 3:this.Core.SetChrRomPage1K(5,31&e);break;case 4:this.Core.SetChrRomPage1K(6,31&e);break;case 5:this.Core.SetChrRomPage1K(7,31&e);break;case 6:this.Core.SetPrgRomPage8K(0,15&e);break;case 7:this.Core.SetPrgRomPage8K(1,15&e)}},r.prototype.Mapper97=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper97.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper97.prototype.Init=function(){this.Core.SetPrgRomPage(0,this.Core.PrgRomPageCount-1),this.Core.SetPrgRomPage(1,0),this.Core.SetChrRomPage(0)},r.prototype.Mapper97.prototype.Write=function(t,e){switch(this.Core.SetPrgRomPage(1,15&e),192&e){case 0:this.Core.SetMirrors(0,0,0,0);break;case 64:this.Core.SetMirror(!0);break;case 128:this.Core.SetMirror(!1);break;case 192:this.Core.SetMirrors(1,1,1,1)}},r.prototype.Mapper101=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper101.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper101.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,this.Core.PrgRomPageCount-1),this.Core.SetChrRomPage(0)},r.prototype.Mapper101.prototype.WriteSRAM=function(t,e){this.Core.SetChrRomPage(3&e)},r.prototype.Mapper118=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(20)},r.prototype.Mapper118.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper118.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.MAPPER_REG[16]=0,this.MAPPER_REG[17]=1,this.MAPPER_REG[18]=2*(this.Core.PrgRomPageCount-1),this.MAPPER_REG[19]=2*(this.Core.PrgRomPageCount-1)+1,this.Core.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]),this.MAPPER_REG[8]=0,this.MAPPER_REG[9]=1,this.MAPPER_REG[10]=2,this.MAPPER_REG[11]=3,this.MAPPER_REG[12]=4,this.MAPPER_REG[13]=5,this.MAPPER_REG[14]=6,this.MAPPER_REG[15]=7,this.Core.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15])},r.prototype.Mapper118.prototype.Write=function(t,e){switch(57345&t){case 32768:this.MAPPER_REG[0]=e,128===(128&e)?this.Core.SetChrRomPages1K(this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15],this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11]):this.Core.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15]),64===(64&e)?this.Core.SetPrgRomPages8K(this.MAPPER_REG[18],this.MAPPER_REG[17],this.MAPPER_REG[16],this.MAPPER_REG[19]):this.Core.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]);break;case 32769:switch(this.MAPPER_REG[1]=e,128===(128&this.MAPPER_REG[0])?2===(7&this.MAPPER_REG[0])&&(128===(128&e)?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1)):0===(7&this.MAPPER_REG[0])&&(128===(128&e)?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1)),7&this.MAPPER_REG[0]){case 0:e&=254,this.MAPPER_REG[8]=e,this.MAPPER_REG[9]=e+1;break;case 1:e&=254,this.MAPPER_REG[10]=e,this.MAPPER_REG[11]=e+1;break;case 2:this.MAPPER_REG[12]=e;break;case 3:this.MAPPER_REG[13]=e;break;case 4:this.MAPPER_REG[14]=e;break;case 5:this.MAPPER_REG[15]=e;break;case 6:this.MAPPER_REG[16]=e;break;case 7:this.MAPPER_REG[17]=e}128===(128&this.MAPPER_REG[0])?this.Core.SetChrRomPages1K(this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15],this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11]):this.Core.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15]),64===(64&this.MAPPER_REG[0])?this.Core.SetPrgRomPages8K(this.MAPPER_REG[18],this.MAPPER_REG[17],this.MAPPER_REG[16],this.MAPPER_REG[19]):this.Core.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]);break;case 40960:this.MAPPER_REG[2]=e;break;case 40961:this.MAPPER_REG[3]=e;break;case 49152:this.MAPPER_REG[4]=e;break;case 49153:this.MAPPER_REG[5]=e;break;case 57344:this.MAPPER_REG[4]=this.MAPPER_REG[5],this.MAPPER_REG[7]=0,this.ClearIRQ();break;case 57345:this.MAPPER_REG[7]=1}},r.prototype.Mapper118.prototype.HSync=function(t){1===this.MAPPER_REG[7]&&240>t&&8===(8&this.Core.IO1[1])&&(0===--this.MAPPER_REG[4]&&this.SetIRQ(),this.MAPPER_REG[4]&=255)},r.prototype.Mapper119=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(20)},r.prototype.Mapper119.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper119.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.MAPPER_REG[16]=0,this.MAPPER_REG[17]=1,this.MAPPER_REG[18]=2*(this.Core.PrgRomPageCount-1),this.MAPPER_REG[19]=2*(this.Core.PrgRomPageCount-1)+1,this.Core.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]),this.MAPPER_REG[8]=0,this.MAPPER_REG[9]=1,this.MAPPER_REG[10]=2,this.MAPPER_REG[11]=3,this.MAPPER_REG[12]=4,this.MAPPER_REG[13]=5,this.MAPPER_REG[14]=6,this.MAPPER_REG[15]=7,this.Core.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15])},r.prototype.Mapper119.prototype.SetChrRomPages1K=function(t,e,s,r,i,h,o,a){0===(64&t)?this.Core.SetChrRomPage1K(0,63&t):this.Core.VRAM[0]=this.Core.VRAMS[7&t],0===(64&e)?this.Core.SetChrRomPage1K(1,63&e):this.Core.VRAM[1]=this.Core.VRAMS[7&e],0===(64&s)?this.Core.SetChrRomPage1K(2,63&s):this.Core.VRAM[2]=this.Core.VRAMS[7&s],0===(64&r)?this.Core.SetChrRomPage1K(3,63&r):this.Core.VRAM[3]=this.Core.VRAMS[7&r],0===(64&i)?this.Core.SetChrRomPage1K(4,63&i):this.Core.VRAM[4]=this.Core.VRAMS[7&i],0===(64&h)?this.Core.SetChrRomPage1K(5,63&h):this.Core.VRAM[5]=this.Core.VRAMS[7&h],0===(64&o)?this.Core.SetChrRomPage1K(6,63&o):this.Core.VRAM[6]=this.Core.VRAMS[7&o],0===(64&a)?this.Core.SetChrRomPage1K(7,63&a):this.Core.VRAM[7]=this.Core.VRAMS[7&a]},r.prototype.Mapper119.prototype.Write=function(t,e){switch(57345&t){case 32768:this.MAPPER_REG[0]=e,128===(128&e)?this.SetChrRomPages1K(this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15],this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11]):this.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15]),64===(64&e)?this.Core.SetPrgRomPages8K(this.MAPPER_REG[18],this.MAPPER_REG[17],this.MAPPER_REG[16],this.MAPPER_REG[19]):this.Core.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]);break;case 32769:switch(this.MAPPER_REG[1]=e,7&this.MAPPER_REG[0]){case 0:e&=254,this.MAPPER_REG[8]=e,this.MAPPER_REG[9]=e+1;break;case 1:e&=254,this.MAPPER_REG[10]=e,this.MAPPER_REG[11]=e+1;break;case 2:this.MAPPER_REG[12]=e;break;case 3:this.MAPPER_REG[13]=e;break;case 4:this.MAPPER_REG[14]=e;break;case 5:this.MAPPER_REG[15]=e;break;case 6:this.MAPPER_REG[16]=e;break;case 7:this.MAPPER_REG[17]=e}128===(128&this.MAPPER_REG[0])?this.SetChrRomPages1K(this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15],this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11]):this.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15]),64===(64&this.MAPPER_REG[0])?this.Core.SetPrgRomPages8K(this.MAPPER_REG[18],this.MAPPER_REG[17],this.MAPPER_REG[16],this.MAPPER_REG[19]):this.Core.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]);break;case 40960:1===(1&e)?this.Core.SetMirror(!0):this.Core.SetMirror(!1),this.MAPPER_REG[2]=e;break;case 40961:this.MAPPER_REG[3]=e;break;case 49152:this.MAPPER_REG[4]=e;break;case 49153:this.MAPPER_REG[5]=e;break;case 57344:this.MAPPER_REG[4]=this.MAPPER_REG[5],this.MAPPER_REG[7]=0,this.ClearIRQ();break;case 57345:this.MAPPER_REG[7]=1}},r.prototype.Mapper119.prototype.HSync=function(t){1===this.MAPPER_REG[7]&&240>t&&8===(8&this.Core.IO1[1])&&(0===--this.MAPPER_REG[4]&&this.SetIRQ(),this.MAPPER_REG[4]&=255)},r.prototype.Mapper140=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper140.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper140.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,1),this.Core.SetChrRomPage(0)},r.prototype.Mapper140.prototype.WriteSRAM=function(t,e){var s=(48&e)>>3;this.Core.SetPrgRomPage(0,s),this.Core.SetPrgRomPage(1,s+1),this.Core.SetChrRomPage(15&e)},r.prototype.Mapper152=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper152.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper152.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,this.Core.PrgRomPageCount-1),this.Core.SetChrRomPage(0)},r.prototype.Mapper152.prototype.WriteSRAM=function(t,e){this.Core.SetPrgRomPage(0,(112&e)>>4),this.Core.SetChrRomPage(15&e),128===(128&e)?this.Core.SetMirrors(0,0,0,0):this.Core.SetMirrors(1,1,1,1)},r.prototype.Mapper180=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper180.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper180.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,this.Core.PrgRomPageCount-1),this.Core.SetChrRomPage(0)},r.prototype.Mapper180.prototype.Write=function(t,e){this.Core.SetPrgRomPage(1,e)},r.prototype.Mapper184=function(t){r.prototype.MapperProto.apply(this,arguments)},r.prototype.Mapper184.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper184.prototype.Init=function(){this.Core.SetPrgRomPage(0,0),this.Core.SetPrgRomPage(1,this.Core.PrgRomPageCount-1)},r.prototype.Mapper184.prototype.WriteSRAM=function(t,e){var s,r=2*this.Core.ChrRomPageCount-1;s=4*(e&r),this.Core.SetChrRomPage1K(0,s),this.Core.SetChrRomPage1K(1,s+1),this.Core.SetChrRomPage1K(2,s+2),this.Core.SetChrRomPage1K(3,s+3),s=4*(e>>>4&r),this.Core.SetChrRomPage1K(4,s),this.Core.SetChrRomPage1K(5,s+1),this.Core.SetChrRomPage1K(6,s+2),this.Core.SetChrRomPage1K(7,s+3)},r.prototype.Mapper185=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=0,this.EX_ChrRom=new Array(1024)},r.prototype.Mapper185.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper185.prototype.Init=function(){for(var t=0;t<this.EX_ChrRom.length;t++)this.EX_ChrRom[t]=255;this.MAPPER_REG=0,this.Core.SetPrgRomPages8K(0,1,2,3),this.Core.VRAM[0]=this.EX_ChrRom,this.Core.VRAM[1]=this.EX_ChrRom,this.Core.VRAM[2]=this.EX_ChrRom,this.Core.VRAM[3]=this.EX_ChrRom,this.Core.VRAM[4]=this.EX_ChrRom,this.Core.VRAM[5]=this.EX_ChrRom,this.Core.VRAM[6]=this.EX_ChrRom,this.Core.VRAM[7]=this.EX_ChrRom},r.prototype.Mapper185.prototype.Write=function(t,e){this.MAPPER_REG=e,0!==(3&e)?this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7):(this.Core.VRAM[0]=this.EX_ChrRom,this.Core.VRAM[1]=this.EX_ChrRom,this.Core.VRAM[2]=this.EX_ChrRom,this.Core.VRAM[3]=this.EX_ChrRom,this.Core.VRAM[4]=this.EX_ChrRom,this.Core.VRAM[5]=this.EX_ChrRom,this.Core.VRAM[6]=this.EX_ChrRom,this.Core.VRAM[7]=this.EX_ChrRom)},r.prototype.Mapper207=function(t){r.prototype.MapperProto.apply(this,arguments),this.MAPPER_REG=new Array(11),this.EX_RAM=new Array(128)},r.prototype.Mapper207.prototype=Object.create(r.prototype.MapperProto.prototype),r.prototype.Mapper207.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;for(t=0;t<this.EX_RAM.length;t++)this.EX_RAM[t]=0;this.Core.SetPrgRomPages8K(0,1,2,2*this.Core.PrgRomPageCount-1),this.Core.SetChrRomPages1K(0,1,2,3,4,5,6,7)},r.prototype.Mapper207.prototype.ReadSRAM=function(t){if(t>=32512&&32767>=t)return this.EX_RAM[127&t];switch(t){case 32496:return this.MAPPER_REG[0];case 32497:return this.MAPPER_REG[1];case 32498:return this.MAPPER_REG[2];case 32499:return this.MAPPER_REG[3];case 32500:return this.MAPPER_REG[4];case 32501:return this.MAPPER_REG[5];case 32502:case 32503:return this.MAPPER_REG[6];case 32504:case 32505:return this.MAPPER_REG[7];case 32506:case 32507:return this.MAPPER_REG[8];case 32508:case 32509:return this.MAPPER_REG[9];case 32510:case 32511:return this.MAPPER_REG[10]}return 0},r.prototype.Mapper207.prototype.WriteSRAM=function(t,e){if(t>=32512&&32767>=t)return void(this.EX_RAM[127&t]=e);switch(t){case 32496:this.MAPPER_REG[0]=e,0===(128&e)?(this.Core.VRAM[8]=this.Core.VRAMS[8],this.Core.VRAM[9]=this.Core.VRAMS[8]):(this.Core.VRAM[8]=this.Core.VRAMS[9],this.Core.VRAM[9]=this.Core.VRAMS[9]),this.Core.SetChrRomPage1K(0,126&e),this.Core.SetChrRomPage1K(1,(126&e)+1);break;case 32497:this.MAPPER_REG[1]=e,0===(128&e)?(this.Core.SetChrRomPage1K(10,264),this.Core.SetChrRomPage1K(11,264)):(this.Core.SetChrRomPage1K(10,265),this.Core.SetChrRomPage1K(11,265)),this.Core.SetChrRomPage1K(2,126&e),this.Core.SetChrRomPage1K(3,(126&e)+1);break;case 32498:this.MAPPER_REG[2]=e,this.Core.SetChrRomPage1K(4,e);break;case 32499:this.MAPPER_REG[3]=e,this.Core.SetChrRomPage1K(5,e);break;case 32500:this.MAPPER_REG[4]=e,this.Core.SetChrRomPage1K(6,e);break;case 32501:this.MAPPER_REG[5]=e,this.Core.SetChrRomPage1K(7,e);break;case 32504:case 32505:this.MAPPER_REG[7]=e;break;case 32506:case 32507:this.MAPPER_REG[8]=e,this.Core.SetPrgRomPage8K(0,e);break;case 32508:case 32509:this.MAPPER_REG[9]=e,this.Core.SetPrgRomPage8K(1,e);break;case 32510:case 32511:this.MAPPER_REG[10]=e,this.Core.SetPrgRomPage8K(2,e)}},r.prototype.MapperSelect=function(){switch(this.MapperNumber){case 0:this.Mapper=new this.Mapper0(this);break;case 1:this.Mapper=new this.Mapper1(this);break;case 2:this.Mapper=new this.Mapper2(this);break;case 3:this.Mapper=new this.Mapper3(this);break;case 4:this.Mapper=new this.Mapper4(this);break;case 5:this.Mapper=new this.Mapper5(this);break;case 7:this.Mapper=new this.Mapper7(this);break;case 9:this.Mapper=new this.Mapper9(this);break;case 10:this.Mapper=new this.Mapper10(this);break;case 16:this.Mapper=new this.Mapper16(this);break;case 18:this.Mapper=new this.Mapper18(this);break;case 19:this.Mapper=new this.Mapper19(this);break;case 20:this.Mapper=new this.Mapper20(this);break;case 21:this.Mapper=new this.Mapper25(this);break;case 22:this.Mapper=new this.Mapper22(this);break;case 23:this.Mapper=new this.Mapper23(this);break;case 24:this.Mapper=new this.Mapper24(this);break;case 25:this.Mapper=new this.Mapper25(this);break;case 26:this.Mapper=new this.Mapper26(this);break;case 32:this.Mapper=new this.Mapper32(this);break;case 33:this.Mapper=new this.Mapper33(this);break;case 34:this.Mapper=new this.Mapper34(this);break;case 48:this.Mapper=new this.Mapper48(this);break;case 65:this.Mapper=new this.Mapper65(this);break;case 66:this.Mapper=new this.Mapper66(this);break;case 67:this.Mapper=new this.Mapper67(this);break;case 68:this.Mapper=new this.Mapper68(this);break;case 69:this.Mapper=new this.Mapper69(this);
break;case 70:this.Mapper=new this.Mapper70(this);break;case 72:this.Mapper=new this.Mapper72(this);break;case 73:this.Mapper=new this.Mapper73(this);break;case 75:this.Mapper=new this.Mapper75(this);break;case 76:this.Mapper=new this.Mapper76(this);break;case 77:this.Mapper=new this.Mapper77(this);break;case 78:this.Mapper=new this.Mapper78(this);break;case 80:this.Mapper=new this.Mapper80(this);break;case 82:this.Mapper=new this.Mapper82(this);break;case 85:this.Mapper=new this.Mapper85(this);break;case 86:this.Mapper=new this.Mapper86(this);break;case 87:this.Mapper=new this.Mapper87(this);break;case 88:this.Mapper=new this.Mapper88(this);break;case 89:this.Mapper=new this.Mapper89(this);break;case 92:this.Mapper=new this.Mapper92(this);break;case 93:this.Mapper=new this.Mapper93(this);break;case 94:this.Mapper=new this.Mapper94(this);break;case 95:this.Mapper=new this.Mapper95(this);break;case 97:this.Mapper=new this.Mapper97(this);break;case 101:this.Mapper=new this.Mapper101(this);break;case 118:this.Mapper=new this.Mapper118(this);break;case 119:this.Mapper=new this.Mapper119(this);break;case 140:this.Mapper=new this.Mapper140(this);break;case 152:this.Mapper=new this.Mapper152(this);break;case 180:this.Mapper=new this.Mapper180(this);break;case 184:this.Mapper=new this.Mapper184(this);break;case 185:this.Mapper=new this.Mapper185(this);break;case 207:this.Mapper=new this.Mapper207(this);break;case 210:this.Mapper=new this.Mapper19(this);break;default:return!1}return!0},e.exports=r},{"./NES":2}],2:[function(t,e,s){"use strict";var r=function(){this.Use_requestAnimationFrame="undefined"!=typeof window.requestAnimationFrame,this.Use_GetGamepads="undefined"!=typeof navigator.getGamepads,window.AudioContext=window.AudioContext||window.webkitAudioContext,this.Use_AudioContext="undefined"!=typeof window.AudioContext,this.TimerID=null,this.StateData=null,this.CycleTable=[7,6,2,8,3,3,5,5,3,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,6,6,2,8,3,3,5,5,4,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,6,6,2,8,3,3,5,5,3,2,2,2,3,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,6,6,2,8,3,3,5,5,4,2,2,2,5,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,5,2,6,4,4,4,4,2,4,2,5,5,4,5,5,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,5,2,5,4,4,4,4,2,4,2,4,4,4,4,4,2,6,2,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,2,6,2,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7],this.MainClock=1789772.5,this.A=0,this.X=0,this.Y=0,this.S=0,this.P=0,this.PC=0,this.toNMI=!1,this.toIRQ=0,this.CPUClock=0,this.ZNCacheTable=new Array(256),this.ZNCacheTable[0]=2;var t;for(t=1;256>t;t++)this.ZNCacheTable[t]=128&t;for(this.ZNCacheTableCMP=new Array(512),t=0;256>t;t++)this.ZNCacheTableCMP[t]=1|this.ZNCacheTable[t],this.ZNCacheTableCMP[t+256]=this.ZNCacheTable[t];for(this.ScrollRegisterFlag=!1,this.PPUAddressRegisterFlag=!1,this.HScrollTmp=0,this.PPUAddress=0,this.PPUAddressBuffer=0,this.Palette=null,this.SpriteLineBuffer=null,this.PPUReadBuffer=0,this.PaletteTable=[[120,120,120],[32,0,176],[40,0,184],[96,16,160],[152,32,120],[176,16,48],[160,48,0],[120,64,0],[72,88,0],[56,104,0],[56,108,0],[48,96,64],[48,80,128],[0,0,0],[0,0,0],[0,0,0],[176,176,176],[64,96,248],[64,64,255],[144,64,240],[216,64,192],[216,64,96],[224,80,0],[192,112,0],[136,136,0],[80,160,0],[72,168,16],[72,160,104],[64,144,192],[0,0,0],[0,0,0],[0,0,0],[255,255,255],[96,160,255],[80,128,255],[160,112,255],[240,96,255],[255,96,176],[255,120,48],[255,160,0],[232,208,32],[152,232,0],[112,240,64],[112,224,144],[96,208,224],[120,120,120],[0,0,0],[0,0,0],[255,255,255],[144,208,255],[160,184,255],[192,176,255],[224,176,255],[255,184,232],[255,200,184],[255,216,160],[255,240,144],[200,240,128],[160,240,160],[160,255,200],[160,255,240],[160,160,160],[0,0,0],[0,0,0]],this.BgLineBuffer=null,this.SPBitArray=new Array(256),t=0;256>t;t++){this.SPBitArray[t]=new Array(256);for(var e=0;256>e;e++){this.SPBitArray[t][e]=new Array(8);for(var s=0;8>s;s++)this.SPBitArray[t][e][s]=(t<<s&128)>>>7|(e<<s&128)>>>6}}for(this.PaletteArray=[16,1,2,3,16,5,6,7,16,9,10,11,16,13,14,15],this.PpuX=0,this.PpuY=0,this.Canvas=null,this.ctx=null,this.ImageData=null,this.DrawFlag=!1,this.Sprite0Line=!1,this.SpriteLimit=!0,this.PrgRomPageCount=0,this.ChrRomPageCount=0,this.HMirror=!1,this.VMirror=!1,this.SramEnable=!1,this.TrainerEnable=!1,this.FourScreen=!1,this.MapperNumber=-1,this.RAM=new Array(2048),this.INNERSRAM=new Array(8192),this.SRAM=null,this.VRAM=new Array(16),this.VRAMS=new Array(16),t=0;16>t;t++)this.VRAMS[t]=new Array(1024);for(this.SPRITE_RAM=new Array(256),this.ROM=new Array(4),this.ROM_RAM=new Array(4),t=0;4>t;t++)this.ROM_RAM[t]=new Array(8192);this.PRGROM_STATE=new Array(4),this.CHRROM_STATE=new Array(8),this.PRGROM_PAGES=null,this.CHRROM_PAGES=null,this.IO1=new Array(8),this.IO2=new Array(32),this.Rom=null,this.JoyPadStrobe=!1,this.JoyPadState=[0,0],this.JoyPadBuffer=[0,0],this.JoyPadKeyUpFunction=null,this.JoyPadKeyDownFunction=null,this.WaveOut=!0,this.WaveDatas=[],this.WaveBaseCount=0,this.WaveSampleRate=24e3,this.WaveFrameSequence=0,this.WaveFrameSequenceCounter=0,this.WaveVolume=.5,this.WaveCh1LengthCounter=0,this.WaveCh1Envelope=0,this.WaveCh1EnvelopeCounter=0,this.WaveCh1Sweep=0,this.WaveCh1Frequency=0,this.WaveCh2LengthCounter=0,this.WaveCh2Envelope=0,this.WaveCh2EnvelopeCounter=0,this.WaveCh2Sweep=0,this.WaveCh2Frequency=0,this.WaveCh3LengthCounter=0,this.WaveCh3LinearCounter=0,this.WaveCh4Angle=-1,this.WaveCh4LengthCounter=0,this.WaveCh4Envelope=0,this.WaveCh4EnvelopeCounter=0,this.WaveCh4Register=0,this.WaveCh4BitSequence=0,this.WaveCh4Angle=0,this.WaveCh5Angle=-1,this.WaveCh5DeltaCounter=0,this.WaveCh5Register=0,this.WaveCh5SampleAddress=0,this.WaveCh5SampleCounter=0,this.ApuClockCounter=0,this.WaveLengthCount=[10,254,20,2,40,4,80,6,160,8,60,10,14,12,26,14,12,16,24,18,48,20,96,22,192,24,72,26,16,28,32,30],this.WaveCh1_2DutyData=[4,8,16,24],this.WaveCh3SequenceData=[15,13,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-13,-15,-15,-13,-11,-9,-7,-5,-3,-1,1,3,5,7,9,11,13,15],this.WaveCh4FrequencyData=[4,8,16,32,64,96,128,160,202,254,380,508,762,1016,2034,4068],this.WaveCh5FrequencyData=[428,380,340,320,286,254,226,214,190,160,142,128,106,84,72,54],this.WebAudioCtx=null,this.WebAudioJsNode=null,this.WebAudioGainNode=null,this.WebAudioBufferSize=4096,this.ApuCpuClockCounter=0,this.Use_AudioContext&&(this.WebAudioCtx=new window.AudioContext,this.WebAudioJsNode=this.WebAudioCtx.createScriptProcessor(this.WebAudioBufferSize,1,1),this.WebAudioJsNode.onaudioprocess=this.WebAudioFunction.bind(this),this.WebAudioGainNode=this.WebAudioCtx.createGain(),this.WebAudioJsNode.connect(this.WebAudioGainNode),this.WebAudioGainNode.connect(this.WebAudioCtx.destination),this.WaveSampleRate=this.WebAudioCtx.sampleRate),this.FDS_WAVE_REG=new Array(64),this.FDS_LFO_REG=new Array(32),this.FDS_REG=new Array(16),this.FDS_LFO_DATA=[0,1,2,4,0,-4,-2,-1],this.FDS_WaveIndexCounter=0,this.FDS_WaveIndex=0,this.FDS_LFOIndexCounter=0,this.FDS_LFOIndex=0,this.FDS_REGAddress=0,this.FDS_VolumeEnvCounter=0,this.FDS_VolumeEnv=0,this.FDS_SweepEnvCounter=0,this.FDS_SweepEnv=0,this.FDS_SweepBias=0,this.FDS_Volume=0,this.MMC5_FrameSequenceCounter=0,this.MMC5_FrameSequence=0,this.MMC5_REG=new Array(32),this.MMC5_Ch=new Array(2),this.MMC5_Level=0,this.VRC6_REG=new Array(12),this.VRC6_Ch3_Counter=0,this.VRC6_Ch3_index=0,this.VRC6_Level=0,this.N163_ch_data=new Array(8),this.N163_RAM=new Array(128),this.N163_Address=0,this.N163_ch=0,this.N163_Level=0,this.N163_Clock=0,this.AY_ClockCounter=0,this.AY_REG=new Array(16),this.AY_Noise_Seed=1,this.AY_Noise_Angle=0,this.AY_Env_Counter=0,this.AY_Env_Index=0,this.AY_REG_Select=0,this.AY_Level=0,this.AY_Env_Pattern=[[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],this.AY_Env_Volume=[0,16,23,32,45,64,90,128,181,256,362,512,724,1023,1447,2047],this.Mapper=null};r.prototype.requestAnimationFrame=function(){this.Use_requestAnimationFrame?this.UpdateAnimationFrame():this.TimerID=setInterval(this.Run.bind(this),16)},r.prototype.cancelAnimationFrame=function(){this.cancelAnimationFrame?window.cancelAnimationFrame(this.TimerID):clearInterval(this.TimerID)},r.prototype.UpdateAnimationFrame=function(){this.TimerID=window.requestAnimationFrame(this.UpdateAnimationFrame.bind(this)),this.Run()},r.prototype.Run=function(){this.CheckGamePad(),this.CpuRun()},r.prototype.Start=function(){return null!==this.Mapper&&null===this.TimerID?(this.JoyPadInit(),this.TimerID=this.requestAnimationFrame(),!0):!1},r.prototype.Pause=function(){return null!==this.Mapper&&null!==this.TimerID?(this.cancelAnimationFrame(),this.JoyPadRelease(),this.TimerID=null,!0):!1},r.prototype.Init=function(){return this.ParseHeader(),this.StorageClear(),this.StorageInit(),this.PpuInit(),this.ApuInit(),this.MapperSelect()?(this.Mapper.Init(),this.CpuInit(),!0):(window.alert("Unsupported Mapper : "+this.MapperNumber),!1)},r.prototype.Reset=function(){return null!==this.Mapper?(this.Pause(),this.PpuInit(),this.ApuInit(),this.Mapper.Init(),this.CpuReset(),this.Start(),!0):!1},r.prototype.CpuInit=function(){this.A=0,this.X=0,this.Y=0,this.S=253,this.P=52,this.toNMI=!1,this.toIRQ=0,this.PC=this.Get16(65532),this.Set(8,247),this.Set(9,239),this.Set(10,223),this.Set(15,191)},r.prototype.CpuReset=function(){this.S=this.S-3&255,this.P|=4,this.toNMI=!1,this.toIRQ=0,this.PC=this.Get16(65532)},r.prototype.NMI=function(){this.CPUClock+=7,this.Push(this.PC>>8&255),this.Push(255&this.PC),this.Push(239&this.P|32),this.P=239&(4|this.P),this.PC=this.Get16(65530)},r.prototype.IRQ=function(){this.CPUClock+=7,this.Push(this.PC>>8&255),this.Push(255&this.PC),this.Push(239&this.P|32),this.P=239&(4|this.P),this.PC=this.Get16(65534)},r.prototype.GetAddressZeroPage=function(){return this.Get(this.PC++)},r.prototype.GetAddressImmediate=function(){return this.PC++},r.prototype.GetAddressAbsolute=function(){return this.Get(this.PC++)|this.Get(this.PC++)<<8},r.prototype.GetAddressZeroPageX=function(){return this.X+this.Get(this.PC++)&255},r.prototype.GetAddressZeroPageY=function(){return this.Y+this.Get(this.PC++)&255},r.prototype.GetAddressIndirectX=function(){var t=this.Get(this.PC++)+this.X&255;return this.Get(t)|this.Get(t+1&255)<<8},r.prototype.GetAddressIndirectY=function(){var t=this.Get(this.PC++);t=this.Get(t)|this.Get(t+1&255)<<8;var e=t+this.Y;return(256&(e^t))>0&&(this.CPUClock+=1),e},r.prototype.GetAddressAbsoluteX=function(){var t=this.Get(this.PC++)|this.Get(this.PC++)<<8,e=t+this.X;return(256&(e^t))>0&&(this.CPUClock+=1),e},r.prototype.GetAddressAbsoluteY=function(){var t=this.Get(this.PC++)|this.Get(this.PC++)<<8,e=t+this.Y;return(256&(e^t))>0&&(this.CPUClock+=1),e},r.prototype.Push=function(t){this.RAM[256+this.S]=t,this.S=this.S-1&255},r.prototype.Pop=function(){return this.S=this.S+1&255,this.RAM[256+this.S]},r.prototype.LDA=function(t){this.A=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},r.prototype.LDX=function(t){this.X=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.X]},r.prototype.LDY=function(t){this.Y=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.Y]},r.prototype.STA=function(t){this.Set(t,this.A)},r.prototype.STX=function(t){this.Set(t,this.X)},r.prototype.STY=function(t){this.Set(t,this.Y)},r.prototype.Adder=function(t){var e=this.A,s=e+t+(1&this.P);this.A=255&s,this.P=60&this.P|(~(e^t)&(e^s)&128)>>>1|s>>>8|this.ZNCacheTable[this.A]},r.prototype.ADC=function(t){this.Adder(this.Get(t))},r.prototype.SBC=function(t){this.Adder(255&~this.Get(t))},r.prototype.CMP=function(t){this.P=124&this.P|this.ZNCacheTableCMP[this.A-this.Get(t)&511]},r.prototype.CPX=function(t){this.P=124&this.P|this.ZNCacheTableCMP[this.X-this.Get(t)&511]},r.prototype.CPY=function(t){this.P=124&this.P|this.ZNCacheTableCMP[this.Y-this.Get(t)&511]},r.prototype.AND=function(t){this.A&=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},r.prototype.EOR=function(t){this.A^=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},r.prototype.ORA=function(t){this.A|=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},r.prototype.BIT=function(t){var e=this.Get(t);this.P=61&this.P|2&this.ZNCacheTable[e&this.A]|192&e},r.prototype.ASL_Sub=function(t){return this.P=254&this.P|t>>7,t=t<<1&255,this.P=125&this.P|this.ZNCacheTable[t],t},r.prototype.ASL=function(t){this.Set(t,this.ASL_Sub(this.Get(t)))},r.prototype.LSR_Sub=function(t){return this.P=124&this.P|1&t,t>>=1,this.P|=this.ZNCacheTable[t],t},r.prototype.LSR=function(t){this.Set(t,this.LSR_Sub(this.Get(t)))},r.prototype.ROL_Sub=function(t){var e=t>>7;return t=t<<1&255|1&this.P,this.P=124&this.P|e|this.ZNCacheTable[t],t},r.prototype.ROL=function(t){this.Set(t,this.ROL_Sub(this.Get(t)))},r.prototype.ROR_Sub=function(t){var e=1&t;return t=t>>1|(1&this.P)<<7,this.P=124&this.P|e|this.ZNCacheTable[t],t},r.prototype.ROR=function(t){this.Set(t,this.ROR_Sub(this.Get(t)))},r.prototype.INC=function(t){var e=this.Get(t)+1&255;this.P=125&this.P|this.ZNCacheTable[e],this.Set(t,e)},r.prototype.DEC=function(t){var e=this.Get(t)-1&255;this.P=125&this.P|this.ZNCacheTable[e],this.Set(t,e)},r.prototype.Branch=function(t){if(!t)return void this.PC++;var e=this.Get(this.PC),s=this.PC+1;this.PC=s+(e>=128?e-256:e)&65535,this.CPUClock+=(256&(s^this.PC))>0?2:1},r.prototype.ANC=function(t){this.A&=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A],this.P=254&this.P|this.A>>>7},r.prototype.ANE=function(t){this.A=(238|this.A)&this.X&this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},r.prototype.ARR=function(t){this.A&=this.Get(t),this.A=this.A>>1|(1&this.P)<<7,this.P=125&this.P|this.ZNCacheTable[this.A],this.P=254&this.P|(64&this.A)>>6;var e=64&(this.A^this.A<<1);this.P=191&this.P|e},r.prototype.ASR=function(t){this.A&=this.Get(t),this.P=254&this.P|1&this.A,this.A=this.A>>1,this.P=125&this.P|this.ZNCacheTable[this.A]},r.prototype.DCP=function(t){var e=this.Get(t)-1&255;this.P=124&this.P|this.ZNCacheTableCMP[this.A-e&511],this.Set(t,e)},r.prototype.ISB=function(t){var e=this.Get(t)+1&255;this.Adder(255&~e),this.Set(t,e)},r.prototype.LAS=function(t){var e=this.Get(t)&this.S;this.A=this.X=this.S=e,this.P=125&this.P|this.ZNCacheTable[this.A]},r.prototype.LAX=function(t){this.A=this.X=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},r.prototype.LXA=function(t){var e=(238|this.A)&this.Get(t);this.A=this.X=e,this.P=125&this.P|this.ZNCacheTable[this.A]},r.prototype.RLA=function(t){var e=this.Get(t);e=e<<1|1&this.P,this.P=254&this.P|e>>8,this.A&=e,this.P=125&this.P|this.ZNCacheTable[this.A],this.Set(t,e)},r.prototype.RRA=function(t){var e=this.Get(t),s=1&e;e=e>>1|(1&this.P)<<7,this.P=254&this.P|s,this.Adder(e),this.Set(t,e)},r.prototype.SAX=function(t){var e=this.A&this.X;this.Set(t,e)},r.prototype.SBX=function(t){var e=(this.A&this.X)-this.Get(t);this.P=254&this.P|~e>>8&1,this.X=255&e,this.P=125&this.P|this.ZNCacheTable[this.X]},r.prototype.SHA=function(t){var e=this.A&this.X&(t>>8)+1;this.Set(t,e)},r.prototype.SHS=function(t){this.S=this.A&this.X;var e=this.S&(t>>8)+1;this.Set(t,e)},r.prototype.SHX=function(t){var e=this.X&(t>>8)+1;this.Set(t,e)},r.prototype.SHY=function(t){var e=this.Y&(t>>8)+1;this.Set(t,e)},r.prototype.SLO=function(t){var e=this.Get(t);this.P=254&this.P|e>>7,e=e<<1&255,this.A|=e,this.P=125&this.P|this.ZNCacheTable[this.A],this.Set(t,e)},r.prototype.SRE=function(t){var e=this.Get(t);this.P=254&this.P|1&e,e>>=1,this.A^=e,this.P=125&this.P|this.ZNCacheTable[this.A],this.Set(t,e)},r.prototype.CpuRun=function(){this.DrawFlag=!1;var t=this.CycleTable,e=this.Mapper;do{this.toNMI?(this.NMI(),this.toNMI=!1):0===(4&this.P)&&0!==this.toIRQ&&this.IRQ();var s=this.Get(this.PC++);switch(this.CPUClock+=t[s],e.CPUSync(this.CPUClock),this.PpuRun(),this.ApuRun(),this.CPUClock=0,s){case 161:this.LDA(this.GetAddressIndirectX());break;case 165:this.LDA(this.GetAddressZeroPage());break;case 169:this.LDA(this.GetAddressImmediate());break;case 173:this.LDA(this.GetAddressAbsolute());break;case 177:this.LDA(this.GetAddressIndirectY());break;case 181:this.LDA(this.GetAddressZeroPageX());break;case 185:this.LDA(this.GetAddressAbsoluteY());break;case 189:this.LDA(this.GetAddressAbsoluteX());break;case 162:this.LDX(this.GetAddressImmediate());break;case 166:this.LDX(this.GetAddressZeroPage());break;case 174:this.LDX(this.GetAddressAbsolute());break;case 182:this.LDX(this.GetAddressZeroPageY());break;case 190:this.LDX(this.GetAddressAbsoluteY());break;case 160:this.LDY(this.GetAddressImmediate());break;case 164:this.LDY(this.GetAddressZeroPage());break;case 172:this.LDY(this.GetAddressAbsolute());break;case 180:this.LDY(this.GetAddressZeroPageX());break;case 188:this.LDY(this.GetAddressAbsoluteX());break;case 129:this.STA(this.GetAddressIndirectX());break;case 133:this.STA(this.GetAddressZeroPage());break;case 141:this.STA(this.GetAddressAbsolute());break;case 145:this.STA(this.GetAddressIndirectY());break;case 149:this.STA(this.GetAddressZeroPageX());break;case 153:this.STA(this.GetAddressAbsoluteY());break;case 157:this.STA(this.GetAddressAbsoluteX());break;case 134:this.STX(this.GetAddressZeroPage());break;case 142:this.STX(this.GetAddressAbsolute());break;case 150:this.STX(this.GetAddressZeroPageY());break;case 132:this.STY(this.GetAddressZeroPage());break;case 140:this.STY(this.GetAddressAbsolute());break;case 148:this.STY(this.GetAddressZeroPageX());break;case 138:this.A=this.X,this.P=125&this.P|this.ZNCacheTable[this.A];break;case 152:this.A=this.Y,this.P=125&this.P|this.ZNCacheTable[this.A];break;case 154:this.S=this.X;break;case 168:this.Y=this.A,this.P=125&this.P|this.ZNCacheTable[this.A];break;case 170:this.X=this.A,this.P=125&this.P|this.ZNCacheTable[this.A];break;case 186:this.X=this.S,this.P=125&this.P|this.ZNCacheTable[this.X];break;case 8:this.Push(48|this.P);break;case 40:this.P=this.Pop();break;case 72:this.Push(this.A);break;case 104:this.A=this.Pop(),this.P=125&this.P|this.ZNCacheTable[this.A];break;case 97:this.ADC(this.GetAddressIndirectX());break;case 101:this.ADC(this.GetAddressZeroPage());break;case 105:this.ADC(this.GetAddressImmediate());break;case 109:this.ADC(this.GetAddressAbsolute());break;case 113:this.ADC(this.GetAddressIndirectY());break;case 117:this.ADC(this.GetAddressZeroPageX());break;case 121:this.ADC(this.GetAddressAbsoluteY());break;case 125:this.ADC(this.GetAddressAbsoluteX());break;case 225:this.SBC(this.GetAddressIndirectX());break;case 229:this.SBC(this.GetAddressZeroPage());break;case 233:this.SBC(this.GetAddressImmediate());break;case 237:this.SBC(this.GetAddressAbsolute());break;case 241:this.SBC(this.GetAddressIndirectY());break;case 245:this.SBC(this.GetAddressZeroPageX());break;case 249:this.SBC(this.GetAddressAbsoluteY());break;case 253:this.SBC(this.GetAddressAbsoluteX());break;case 193:this.CMP(this.GetAddressIndirectX());break;case 197:this.CMP(this.GetAddressZeroPage());break;case 201:this.CMP(this.GetAddressImmediate());break;case 205:this.CMP(this.GetAddressAbsolute());break;case 209:this.CMP(this.GetAddressIndirectY());break;case 213:this.CMP(this.GetAddressZeroPageX());break;case 217:this.CMP(this.GetAddressAbsoluteY());break;case 221:this.CMP(this.GetAddressAbsoluteX());break;case 224:this.CPX(this.GetAddressImmediate());break;case 228:this.CPX(this.GetAddressZeroPage());break;case 236:this.CPX(this.GetAddressAbsolute());break;case 192:this.CPY(this.GetAddressImmediate());break;case 196:this.CPY(this.GetAddressZeroPage());break;case 204:this.CPY(this.GetAddressAbsolute());break;case 33:this.AND(this.GetAddressIndirectX());break;case 37:this.AND(this.GetAddressZeroPage());break;case 41:this.AND(this.GetAddressImmediate());break;case 45:this.AND(this.GetAddressAbsolute());break;case 49:this.AND(this.GetAddressIndirectY());break;case 53:this.AND(this.GetAddressZeroPageX());break;case 57:this.AND(this.GetAddressAbsoluteY());break;case 61:this.AND(this.GetAddressAbsoluteX());break;case 65:this.EOR(this.GetAddressIndirectX());break;case 69:this.EOR(this.GetAddressZeroPage());break;case 73:this.EOR(this.GetAddressImmediate());break;case 77:this.EOR(this.GetAddressAbsolute());break;case 81:this.EOR(this.GetAddressIndirectY());break;case 85:this.EOR(this.GetAddressZeroPageX());break;case 89:this.EOR(this.GetAddressAbsoluteY());break;case 93:this.EOR(this.GetAddressAbsoluteX());break;case 1:this.ORA(this.GetAddressIndirectX());break;case 5:this.ORA(this.GetAddressZeroPage());break;case 9:this.ORA(this.GetAddressImmediate());break;case 13:this.ORA(this.GetAddressAbsolute());break;case 17:this.ORA(this.GetAddressIndirectY());break;case 21:this.ORA(this.GetAddressZeroPageX());break;case 25:this.ORA(this.GetAddressAbsoluteY());break;case 29:this.ORA(this.GetAddressAbsoluteX());break;case 36:this.BIT(this.GetAddressZeroPage());break;case 44:this.BIT(this.GetAddressAbsolute());break;case 6:this.ASL(this.GetAddressZeroPage());break;case 10:this.A=this.ASL_Sub(this.A);break;case 14:this.ASL(this.GetAddressAbsolute());break;case 22:this.ASL(this.GetAddressZeroPageX());break;case 30:this.ASL(this.GetAddressAbsoluteX());break;case 70:this.LSR(this.GetAddressZeroPage());break;case 74:this.A=this.LSR_Sub(this.A);break;case 78:this.LSR(this.GetAddressAbsolute());break;case 86:this.LSR(this.GetAddressZeroPageX());break;case 94:this.LSR(this.GetAddressAbsoluteX());break;case 38:this.ROL(this.GetAddressZeroPage());break;case 42:this.A=this.ROL_Sub(this.A);break;case 46:this.ROL(this.GetAddressAbsolute());break;case 54:this.ROL(this.GetAddressZeroPageX());break;case 62:this.ROL(this.GetAddressAbsoluteX());break;case 102:this.ROR(this.GetAddressZeroPage());break;case 106:this.A=this.ROR_Sub(this.A);break;case 110:this.ROR(this.GetAddressAbsolute());break;case 118:this.ROR(this.GetAddressZeroPageX());break;case 126:this.ROR(this.GetAddressAbsoluteX());break;case 230:this.INC(this.GetAddressZeroPage());break;case 238:this.INC(this.GetAddressAbsolute());break;case 246:this.INC(this.GetAddressZeroPageX());break;case 254:this.INC(this.GetAddressAbsoluteX());break;case 232:this.X=this.X+1&255,this.P=125&this.P|this.ZNCacheTable[this.X];break;case 200:this.Y=this.Y+1&255,this.P=125&this.P|this.ZNCacheTable[this.Y];break;case 198:this.DEC(this.GetAddressZeroPage());break;case 206:this.DEC(this.GetAddressAbsolute());break;case 214:this.DEC(this.GetAddressZeroPageX());break;case 222:this.DEC(this.GetAddressAbsoluteX());break;case 202:this.X=this.X-1&255,this.P=125&this.P|this.ZNCacheTable[this.X];break;case 136:this.Y=this.Y-1&255,this.P=125&this.P|this.ZNCacheTable[this.Y];break;case 24:this.P&=254;break;case 88:this.P&=251;break;case 184:this.P&=191;break;case 216:this.P&=247;break;case 56:this.P|=1;break;case 120:this.P|=4;break;case 248:this.P|=8;break;case 234:break;case 0:this.Push(++this.PC>>8),this.Push(255&this.PC),this.Push(48|this.P),this.P|=20,this.PC=this.Get16(65534);break;case 76:this.PC=this.GetAddressAbsolute();break;case 108:var r=this.GetAddressAbsolute(),i=r+1&255|65280&r;this.PC=this.Get(r)|this.Get(i)<<8;break;case 32:var h=this.PC+1&65535;this.Push(h>>8),this.Push(255&h),this.PC=this.GetAddressAbsolute();break;case 96:this.PC=(this.Pop()|this.Pop()<<8)+1;break;case 64:this.P=this.Pop(),this.PC=this.Pop()|this.Pop()<<8;break;case 16:this.Branch(0===(128&this.P));break;case 48:this.Branch(0!==(128&this.P));break;case 80:this.Branch(0===(64&this.P));break;case 112:this.Branch(0!==(64&this.P));break;case 144:this.Branch(0===(1&this.P));break;case 176:this.Branch(0!==(1&this.P));break;case 208:this.Branch(0===(2&this.P));break;case 240:this.Branch(0!==(2&this.P));break;case 11:case 43:this.ANC(this.GetAddressImmediate());break;case 139:this.ANE(this.GetAddressImmediate());break;case 107:this.ARR(this.GetAddressImmediate());break;case 75:this.ASR(this.GetAddressImmediate());break;case 199:this.DCP(this.GetAddressZeroPage());break;case 215:this.DCP(this.GetAddressZeroPageX());break;case 207:this.DCP(this.GetAddressAbsolute());break;case 223:this.DCP(this.GetAddressAbsoluteX());break;case 219:this.DCP(this.GetAddressAbsoluteY());break;case 195:this.DCP(this.GetAddressIndirectX());break;case 211:this.DCP(this.GetAddressIndirectY());break;case 231:this.ISB(this.GetAddressZeroPage());break;case 247:this.ISB(this.GetAddressZeroPageX());break;case 239:this.ISB(this.GetAddressAbsolute());break;case 255:this.ISB(this.GetAddressAbsoluteX());break;case 251:this.ISB(this.GetAddressAbsoluteY());break;case 227:this.ISB(this.GetAddressIndirectX());break;case 243:this.ISB(this.GetAddressIndirectY());break;case 187:this.LAS(this.GetAddressAbsoluteY());break;case 167:this.LAX(this.GetAddressZeroPage());break;case 183:this.LAX(this.GetAddressZeroPageY());break;case 175:this.LAX(this.GetAddressAbsolute());break;case 191:this.LAX(this.GetAddressAbsoluteY());break;case 163:this.LAX(this.GetAddressIndirectX());break;case 179:this.LAX(this.GetAddressIndirectY());break;case 171:this.LXA(this.GetAddressImmediate());break;case 39:this.RLA(this.GetAddressZeroPage());break;case 55:this.RLA(this.GetAddressZeroPageX());break;case 47:this.RLA(this.GetAddressAbsolute());break;case 63:this.RLA(this.GetAddressAbsoluteX());break;case 59:this.RLA(this.GetAddressAbsoluteY());break;case 35:this.RLA(this.GetAddressIndirectX());break;case 51:this.RLA(this.GetAddressIndirectY());break;case 103:this.RRA(this.GetAddressZeroPage());break;case 119:this.RRA(this.GetAddressZeroPageX());break;case 111:this.RRA(this.GetAddressAbsolute());break;case 127:this.RRA(this.GetAddressAbsoluteX());break;case 123:this.RRA(this.GetAddressAbsoluteY());break;case 99:this.RRA(this.GetAddressIndirectX());break;case 115:this.RRA(this.GetAddressIndirectY());break;case 135:this.SAX(this.GetAddressZeroPage());break;case 151:this.SAX(this.GetAddressZeroPageY());break;case 143:this.SAX(this.GetAddressAbsolute());break;case 131:this.SAX(this.GetAddressIndirectX());break;case 203:this.SBX(this.GetAddressImmediate());break;case 159:this.SHA(this.GetAddressAbsoluteY());break;case 147:this.SHA(this.GetAddressIndirectY());break;case 155:this.SHS(this.GetAddressAbsoluteY());break;case 158:this.SHX(this.GetAddressAbsoluteY());break;case 156:this.SHY(this.GetAddressAbsoluteX());break;case 7:this.SLO(this.GetAddressZeroPage());break;case 23:this.SLO(this.GetAddressZeroPageX());break;case 15:this.SLO(this.GetAddressAbsolute());break;case 31:this.SLO(this.GetAddressAbsoluteX());break;case 27:this.SLO(this.GetAddressAbsoluteY());break;case 3:this.SLO(this.GetAddressIndirectX());break;case 19:this.SLO(this.GetAddressIndirectY());break;case 71:this.SRE(this.GetAddressZeroPage());break;case 87:this.SRE(this.GetAddressZeroPageX());break;case 79:this.SRE(this.GetAddressAbsolute());break;case 95:this.SRE(this.GetAddressAbsoluteX());break;case 91:this.SRE(this.GetAddressAbsoluteY());break;case 67:this.SRE(this.GetAddressIndirectX());break;case 83:this.SRE(this.GetAddressIndirectY());break;case 235:this.SBC(this.GetAddressImmediate());break;case 26:case 58:case 90:case 122:case 218:case 250:break;case 128:case 130:case 137:case 194:case 226:case 4:case 68:case 100:case 20:case 52:case 84:case 116:case 212:case 244:this.PC++;break;case 12:case 28:case 60:case 92:case 124:case 220:case 252:this.PC+=2;break;case 2:case 18:case 34:case 50:case 66:case 82:case 98:case 114:case 146:case 178:case 210:case 242:default:window.alert("oops"),this.PC--}}while(!this.DrawFlag)},r.prototype.PpuInit=function(){this.ScrollRegisterFlag=!1,this.PPUAddressRegisterFlag=!1,this.HScrollTmp=0,this.PPUAddress=0,this.PPUAddressBuffer=0,this.Palette=new Array(33);var t;for(t=0;t<this.Palette.length;t++)this.Palette[t]=15;for(this.SpriteLineBuffer=new Array(256),t=0;t<this.SpriteLineBuffer.length;t++)this.SpriteLineBuffer[t]=0;this.PPUReadBuffer=0,this.FourScreen?this.SetMirrors(0,1,2,3):this.SetMirror(this.HMirror),this.BgLineBuffer=new Array(264),this.PpuX=341,this.PpuY=0,this.Sprite0Line=!1},r.prototype.SetMirror=function(t){t?this.SetMirrors(0,0,1,1):this.SetMirrors(0,1,0,1)},r.prototype.SetMirrors=function(t,e,s,r){this.SetChrRomPage1K(8,t+8+256),this.SetChrRomPage1K(9,e+8+256),this.SetChrRomPage1K(10,s+8+256),this.SetChrRomPage1K(11,r+8+256)},r.prototype.SetChrRomPage1K=function(t,e){e>=256?(this.CHRROM_STATE[t]=e,this.VRAM[t]=this.VRAMS[255&e]):this.ChrRomPageCount>0&&(this.CHRROM_STATE[t]=e%(8*this.ChrRomPageCount),this.VRAM[t]=this.CHRROM_PAGES[this.CHRROM_STATE[t]])},r.prototype.SetChrRomPages1K=function(t,e,s,r,i,h,o,a){this.SetChrRomPage1K(0,t),this.SetChrRomPage1K(1,e),this.SetChrRomPage1K(2,s),this.SetChrRomPage1K(3,r),this.SetChrRomPage1K(4,i),this.SetChrRomPage1K(5,h),this.SetChrRomPage1K(6,o),this.SetChrRomPage1K(7,a)},r.prototype.SetChrRomPage=function(t){t<<=3;for(var e=0;8>e;e++)this.SetChrRomPage1K(e,t+e)},r.prototype.SetCanvas=function(t){if(this.Canvas=document.getElementById(t),!this.Canvas.getContext)return!1;this.ctx=this.Canvas.getContext("2d"),this.ImageData=this.ctx.createImageData(256,224);for(var e=0;229376>e;e+=4)this.ImageData.data[e+3]=255;return this.ctx.putImageData(this.ImageData,0,0),!0},r.prototype.PpuRun=function(){var t=this.IO1,e=this.SpriteLineBuffer,s=this.PpuX;for(this.PpuX+=3*this.CPUClock;this.PpuX>=341;){var r=8===(8&t[1]),i=16===(16&t[1]);if(this.PpuX-=341,s=0,this.Sprite0Line=!1,this.PpuY++,262===this.PpuY&&(this.PpuY=0,(r||i)&&(this.PPUAddress=this.PPUAddressBuffer),t[2]&=127),this.Mapper.HSync(this.PpuY),240!==this.PpuY){if(this.PpuY<240){var h,o,a,P=this.Palette,R=this.PaletteTable,p=this.ImageData.data,E=this.BgLineBuffer;if(r||i){if(this.PPUAddress=64480&this.PPUAddress|1055&this.PPUAddressBuffer,this.PpuY>=8&&this.PpuY<232)for(this.BuildBGLine(),this.BuildSpriteLine(),o=this.PpuY-8<<10,h=0;256>h;h++,o+=4)a=R[P[E[h]]],p[o]=a[0],p[o+1]=a[1],p[o+2]=a[2];else{for(E=this.BgLineBuffer,h=0;264>h;h++)E[h]=16;this.BuildSpriteLine()}28672===(28672&this.PPUAddress)?(this.PPUAddress&=36863,928===(992&this.PPUAddress)?this.PPUAddress=64543&(2048^this.PPUAddress):992===(992&this.PPUAddress)?this.PPUAddress&=64543:this.PPUAddress+=32):this.PPUAddress+=4096}else if(this.PpuY>=8&&this.PpuY<232)for(o=this.PpuY-8<<10,a=R[P[16]],h=0;256>h;h++,o+=4)p[o]=a[0],p[o+1]=a[1],p[o+2]=a[2]}}else this.ctx.putImageData(this.ImageData,0,0),this.DrawFlag=!0,this.ScrollRegisterFlag=!1,t[2]=31&t[2]|128,this.toNMI=128===(128&t[0])}if(this.Sprite0Line&&64!==(64&t[2]))for(var C=this.PpuX>255?255:this.PpuX;C>=s;s++)if(0===e[s]){t[2]|=64;break}},r.prototype.BuildBGLine=function(){
var t,e=this.BgLineBuffer;if(8===(8&this.IO1[1])){if(this.Mapper.BuildBGLine(),2!==(2&this.IO1[1]))for(t=0;8>t;t++)e[t]=16}else for(t=0;264>t;t++)e[t]=16},r.prototype.BuildBGLine_SUB=function(){for(var t=this.BgLineBuffer,e=this.VRAM,s=8192|4095&this.PPUAddress,r=(28672&this.PPUAddress)>>12|(16&this.IO1[0])<<8,i=s>>10,h=1023&s,o=e[i],a=this.PaletteArray,P=this.SPBitArray,R=0,p=this.HScrollTmp,E=0;33>E;E++){var C=o[h]<<4|r,M=e[C>>10];C&=1023;for(var A=o[(896&h)>>4|((28&h)>>2)+960]<<2>>((64&h)>>4|2&h)&12,n=P[M[C]][M[C+8]];8>p;p++,R++)t[R]=a[n[p]|A];p=0,31===(31&h)?(h&=65504,o=e[i^=1]):h++}},r.prototype.BuildSpriteLine=function(){this.Mapper.BuildSpriteLine()},r.prototype.BuildSpriteLine_SUB=function(){var t=this.BgLineBuffer,e=4===(4&this.IO1[1])?0:8;if(16===(16&this.IO1[1])){for(var s=this.SpriteLineBuffer,r=0;256>r;r++)s[r]=256;for(var i=this.SPRITE_RAM,h=32===(32&this.IO1[0])?16:8,o=(8&this.IO1[0])<<9,a=this.VRAM,P=this.SPBitArray,R=this.PpuY,p=0,E=0;252>=E;E+=4){var C=i[E]+1;if(!(C>R||R>=C+h)){if(0===E&&(this.Sprite0Line=!0),9===++p&&this.SpriteLimit)break;var M=i[E+3],A=M+8;A>256&&(A=256);var n,_,c=i[E+2],G=(3&c)<<2|16,S=0===(32&c),u=128===(128&c)?h-1-(R-C):R-C,g=((8&u)<<1)+(7&u)+(8===h?(i[E+1]<<4)+o:((254&i[E+1])<<4)+((1&i[E+1])<<12)),y=a[g>>10],d=1023&g,m=P[y[d]][y[d+8]];for(0===(64&c)?(n=0,_=1):(n=7,_=-1);A>M;M++,n+=_){var b=m[n];0!==b&&256===s[M]&&(s[M]=E,M>=e&&(S||16===t[M])&&(t[M]=b|G))}}}p>=8?this.IO1[2]|=32:this.IO1[2]&=223}},r.prototype.WriteScrollRegister=function(t){this.IO1[5]=t,this.ScrollRegisterFlag?this.PPUAddressBuffer=35871&this.PPUAddressBuffer|(248&t)<<2|(7&t)<<12:(this.PPUAddressBuffer=65504&this.PPUAddressBuffer|(248&t)>>3,this.HScrollTmp=7&t),this.ScrollRegisterFlag=!this.ScrollRegisterFlag},r.prototype.WritePPUControlRegister0=function(t){this.IO1[0]=t,this.PPUAddressBuffer=62463&this.PPUAddressBuffer|(3&t)<<10},r.prototype.WritePPUControlRegister1=function(t){this.IO1[1]=t},r.prototype.WritePPUAddressRegister=function(t){this.IO1[6]=t,this.PPUAddressRegisterFlag?this.PPUAddress=this.PPUAddressBuffer=65280&this.PPUAddressBuffer|t:this.PPUAddressBuffer=255&this.PPUAddressBuffer|(63&t)<<8,this.PPUAddressRegisterFlag=!this.PPUAddressRegisterFlag},r.prototype.ReadPPUStatus=function(){var t=this.IO1[2];return this.IO1[2]&=31,this.ScrollRegisterFlag=!1,this.PPUAddressRegisterFlag=!1,t},r.prototype.ReadPPUData=function(){return this.Mapper.ReadPPUData()},r.prototype.ReadPPUData_SUB=function(){var t=this.PPUReadBuffer,e=16383&this.PPUAddress;return this.PPUReadBuffer=this.VRAM[e>>10][1023&e],this.PPUAddress=this.PPUAddress+(4===(4&this.IO1[0])?32:1)&65535,t},r.prototype.WritePPUData=function(t){this.Mapper.WritePPUData(t)},r.prototype.WritePPUData_SUB=function(t){this.IO1[7]=t;var e=16383&this.PPUAddress;if(this.VRAM[e>>10][1023&e]=t,12288>e)return void(this.PPUAddress=this.PPUAddress+(4===(4&this.IO1[0])?32:1)&65535);if(16127>e)return this.VRAM[e-4096>>10][e-4096&1023]=t,void(this.PPUAddress=this.PPUAddress+(4===(4&this.IO1[0])?32:1)&65535);var s=31&e;0===s||16===s?this.Palette[0]=this.Palette[16]=63&t:this.Palette[s]=63&t,this.PPUAddress=this.PPUAddress+(4===(4&this.IO1[0])?32:1)&65535},r.prototype.WriteSpriteData=function(t){this.SPRITE_RAM[this.IO1[3]]=t,this.IO1[3]=this.IO1[3]+1&255},r.prototype.WriteSpriteAddressRegister=function(t){this.IO1[3]=t},r.prototype.StartDMA=function(t){for(var e=t<<8,s=this.SPRITE_RAM,r=this.RAM,i=0;256>i;i++,e++)s[i]=r[e];this.CPUClock+=514},r.prototype.ParseHeader=function(){return this.Rom.length<16||78!==this.Rom[0]||69!==this.Rom[1]||83!==this.Rom[2]||26!==this.Rom[3]?!1:(this.PrgRomPageCount=this.Rom[4],this.ChrRomPageCount=this.Rom[5],this.HMirror=0===(1&this.Rom[6]),this.VMirror=0!==(1&this.Rom[6]),this.SramEnable=0!==(2&this.Rom[6]),this.TrainerEnable=0!==(4&this.Rom[6]),this.FourScreen=0!==(8&this.Rom[6]),this.MapperNumber=this.Rom[6]>>4|240&this.Rom[7],!0)},r.prototype.StorageClear=function(){var t,e;for(t=0;t<this.RAM.length;t++)this.RAM[t]=0;for(t=0;t<this.INNERSRAM.length;t++)this.INNERSRAM[t]=0;for(this.SRAM=this.INNERSRAM,t=0;t<this.PRGROM_STATE.length;t++)this.PRGROM_STATE[t]=0;for(t=0;t<this.CHRROM_STATE.length;t++)this.CHRROM_STATE[t]=0;for(t=0;t<this.VRAMS.length;t++){for(e=0;e<this.VRAMS[t].length;e++)this.VRAMS[t][e]=0;this.SetChrRomPage1K(t,t+256)}for(t=0;t<this.SPRITE_RAM.length;t++)this.SPRITE_RAM[t]=0;for(t=0;t<this.ROM_RAM.length;t++){for(e=0;e<this.ROM_RAM[t].length;e++)this.ROM_RAM[t][e]=0;this.SetPrgRomPage8K(t,-(t+1))}for(t=0;t<this.IO1.length;t++)this.IO1[t]=0;for(t=0;t<this.IO2.length;t++)this.IO2[t]=0;this.IO2[23]=64},r.prototype.SetRom=function(t){if(!(t instanceof ArrayBuffer))return!1;for(var e=new Uint8Array(t),s=[],r=0;r<e.length;r++)s.push(e[r]);return 78!==s[0]||69!==s[1]||83!==s[2]||26!==s[3]?!1:(this.Rom=s.concat(0),!0)},r.prototype.StorageInit=function(){this.PRGROM_PAGES=null,this.CHRROM_PAGES=null;var t;for(this.PRGROM_PAGES=new Array(2*this.PrgRomPageCount),t=0;t<2*this.PrgRomPageCount;t++)this.PRGROM_PAGES[t]=this.Rom.slice(8192*t+16,8192*t+8208);if(this.ChrRomPageCount>0)for(this.CHRROM_PAGES=new Array(8*this.ChrRomPageCount),t=0;t<8*this.ChrRomPageCount;t++)this.CHRROM_PAGES[t]=this.Rom.slice(16384*this.PrgRomPageCount+1024*t+16,16384*this.PrgRomPageCount+1024*t+1040)},r.prototype.Get=function(t){switch(57344&t){case 0:return this.RAM[2047&t];case 8192:switch(7&t){case 2:return this.ReadPPUStatus();case 7:return this.ReadPPUData()}return 0;case 16384:if(t>=16416)return this.Mapper.ReadLow(t);switch(t){case 16405:return this.ReadWaveControl();case 16406:return this.ReadJoyPadRegister1();case 16407:return this.ReadJoyPadRegister2()}return 64;case 24576:return this.Mapper.ReadSRAM(t);case 32768:return this.ROM[0][8191&t];case 40960:return this.ROM[1][8191&t];case 49152:return this.ROM[2][8191&t];case 57344:return this.ROM[3][8191&t]}},r.prototype.Get16=function(t){return this.Get(t)|this.Get(t+1)<<8},r.prototype.Set=function(t,e){switch(57344&t){case 0:return void(this.RAM[2047&t]=e);case 8192:switch(7&t){case 0:return void this.WritePPUControlRegister0(e);case 1:return void this.WritePPUControlRegister1(e);case 2:return;case 3:return void this.WriteSpriteAddressRegister(e);case 4:return void this.WriteSpriteData(e);case 5:return void this.WriteScrollRegister(e);case 6:return void this.WritePPUAddressRegister(e);case 7:return void this.WritePPUData(e)}return;case 16384:if(16416>t){switch(this.IO2[255&t]=e,t){case 16386:return void this.WriteCh1Length0();case 16387:return void this.WriteCh1Length1();case 16390:return void this.WriteCh2Length0();case 16391:return void this.WriteCh2Length1();case 16392:return void this.WriteCh3LinearCounter();case 16395:return void this.WriteCh3Length1();case 16399:return void this.WriteCh4Length1();case 16400:return void this.WriteCh5DeltaControl();case 16401:return void this.WriteCh5DeltaCounter();case 16404:return void this.StartDMA(e);case 16405:return void this.WriteWaveControl();case 16406:return void this.WriteJoyPadRegister1(e)}return}return void this.Mapper.WriteLow(t,e);case 24576:return void this.Mapper.WriteSRAM(t,e);case 32768:case 40960:case 49152:case 57344:return void this.Mapper.Write(t,e)}},r.prototype.SetPrgRomPage8K=function(t,e){0>e?(this.PRGROM_STATE[t]=e,this.ROM[t]=this.ROM_RAM[-(e+1)]):(this.PRGROM_STATE[t]=e%(2*this.PrgRomPageCount),this.ROM[t]=this.PRGROM_PAGES[this.PRGROM_STATE[t]])},r.prototype.SetPrgRomPages8K=function(t,e,s,r){this.SetPrgRomPage8K(0,t),this.SetPrgRomPage8K(1,e),this.SetPrgRomPage8K(2,s),this.SetPrgRomPage8K(3,r)},r.prototype.SetPrgRomPage=function(t,e){this.SetPrgRomPage8K(2*t,2*e),this.SetPrgRomPage8K(2*t+1,2*e+1)},r.prototype.WriteJoyPadRegister1=function(t){var e=1===(1&t);this.JoyPadStrobe&&!e&&(this.JoyPadBuffer[0]=this.JoyPadState[0],this.JoyPadBuffer[1]=this.JoyPadState[1]),this.JoyPadStrobe=e},r.prototype.ReadJoyPadRegister1=function(){var t=1&this.JoyPadBuffer[0];return this.JoyPadBuffer[0]>>>=1,t},r.prototype.ReadJoyPadRegister2=function(){var t=1&this.JoyPadBuffer[1];return this.JoyPadBuffer[1]>>>=1,t},r.prototype.KeyUpFunction=function(t){switch(t.keyCode){case 88:this.JoyPadState[0]&=-2;break;case 90:this.JoyPadState[0]&=-3;break;case 65:this.JoyPadState[0]&=-5;break;case 83:this.JoyPadState[0]&=-9;break;case 38:this.JoyPadState[0]&=-17;break;case 40:this.JoyPadState[0]&=-33;break;case 37:this.JoyPadState[0]&=-65;break;case 39:this.JoyPadState[0]&=-129;break;case 105:this.JoyPadState[1]&=-2;break;case 103:this.JoyPadState[1]&=-3;break;case 104:this.JoyPadState[1]&=-17;break;case 98:this.JoyPadState[1]&=-33;break;case 100:this.JoyPadState[1]&=-65;break;case 102:this.JoyPadState[1]&=-129}t.preventDefault()},r.prototype.KeyDownFunction=function(t){switch(t.keyCode){case 88:this.JoyPadState[0]|=1;break;case 90:this.JoyPadState[0]|=2;break;case 65:this.JoyPadState[0]|=4;break;case 83:this.JoyPadState[0]|=8;break;case 38:this.JoyPadState[0]|=16;break;case 40:this.JoyPadState[0]|=32;break;case 37:this.JoyPadState[0]|=64;break;case 39:this.JoyPadState[0]|=128;break;case 105:this.JoyPadState[1]|=1;break;case 103:this.JoyPadState[1]|=2;break;case 104:this.JoyPadState[1]|=16;break;case 98:this.JoyPadState[1]|=32;break;case 100:this.JoyPadState[1]|=64;break;case 102:this.JoyPadState[1]|=128}t.preventDefault()},r.prototype.JoyPadInit=function(){this.JoyPadKeyUpFunction=this.KeyUpFunction.bind(this),this.JoyPadKeyDownFunction=this.KeyDownFunction.bind(this),document.addEventListener("keyup",this.JoyPadKeyUpFunction,!0),document.addEventListener("keydown",this.JoyPadKeyDownFunction,!0)},r.prototype.JoyPadRelease=function(){document.removeEventListener("keyup",this.JoyPadKeyUpFunction,!0),document.removeEventListener("keydown",this.JoyPadKeyDownFunction,!0)},r.prototype.CheckGamePad=function(){if(this.Use_GetGamepads)for(var t=navigator.getGamepads(),e=0;2>e;e++){var s=t[e];"undefined"!=typeof s&&(this.JoyPadState[e]=0,this.JoyPadState[e]|=s.buttons[1].pressed?1:0,this.JoyPadState[e]|=s.buttons[0].pressed?2:0,this.JoyPadState[e]|=s.buttons[2].pressed?4:0,this.JoyPadState[e]|=s.buttons[3].pressed?8:0,this.JoyPadState[e]|=s.axes[1]<-.5?16:0,this.JoyPadState[e]|=s.axes[1]>.5?32:0,this.JoyPadState[e]|=s.axes[0]<-.5?64:0,this.JoyPadState[e]|=s.axes[0]>.5?128:0)}},r.prototype.WebAudioFunction=function(t){var e,s,r=t.outputBuffer.getChannelData(0);if(0===this.WaveDatas.length)for(s=new Float32Array(this.WebAudioBufferSize),e=0;e<this.WebAudioBufferSize;e++)s[e]=0;else{var i=this.WaveDatas.length>this.WebAudioBufferSize?this.WebAudioBufferSize:this.WaveDatas.length;for(s=new Float32Array(i),e=0;i>e;e++)s[e]=this.WaveDatas[e]/2048;this.WaveDatas=this.WaveDatas.slice(i),this.WaveDatas.length>=2*this.WebAudioBufferSize&&(this.WaveDatas=this.WaveDatas.slice(2*this.WebAudioBufferSize))}r.set(s)},r.prototype.ReadWaveControl=function(){var t=0;return 0!==this.WaveCh1LengthCounter&&(t|=1),0!==this.WaveCh2LengthCounter&&(t|=2),0!==this.WaveCh3LengthCounter&&(t|=4),0!==this.WaveCh4LengthCounter&&(t|=8),0!==this.WaveCh5SampleCounter&&(t|=16),t|=192&this.toIRQ,this.toIRQ&=-65,t},r.prototype.WriteWaveControl=function(){var t=this.IO2[21];1!==(1&t)&&(this.WaveCh1LengthCounter=0),2!==(2&t)&&(this.WaveCh2LengthCounter=0),4!==(4&t)&&(this.WaveCh3LengthCounter=0),8!==(8&t)&&(this.WaveCh4LengthCounter=0),16!==(16&t)?(this.WaveCh5SampleCounter=0,this.toIRQ&=-129):0===this.WaveCh5SampleCounter&&this.SetCh5Delta()},r.prototype.WriteCh1Length0=function(){this.WaveCh1Frequency=((7&this.IO2[3])<<8)+this.IO2[2]+1},r.prototype.WriteCh1Length1=function(){this.WaveCh1LengthCounter=this.WaveLengthCount[this.IO2[3]>>3],this.WaveCh1Envelope=0,this.WaveCh1EnvelopeCounter=15,this.WaveCh1Sweep=0,this.WaveCh1Frequency=((7&this.IO2[3])<<8)+this.IO2[2]+1},r.prototype.WriteCh2Length0=function(){this.WaveCh2Frequency=((7&this.IO2[7])<<8)+this.IO2[6]+1},r.prototype.WriteCh2Length1=function(){this.WaveCh2LengthCounter=this.WaveLengthCount[this.IO2[7]>>3],this.WaveCh2Envelope=0,this.WaveCh2EnvelopeCounter=15,this.WaveCh2Sweep=0,this.WaveCh2Frequency=((7&this.IO2[7])<<8)+this.IO2[6]+1},r.prototype.WriteCh3LinearCounter=function(){this.WaveCh3LinearCounter=127&this.IO2[8]},r.prototype.WriteCh3Length1=function(){this.WaveCh3LengthCounter=this.WaveLengthCount[this.IO2[11]>>3],this.WaveCh3LinearCounter=127&this.IO2[8]},r.prototype.WriteCh4Length1=function(){this.WaveCh4LengthCounter=this.WaveLengthCount[this.IO2[15]>>3],this.WaveCh4Envelope=0,this.WaveCh4EnvelopeCounter=15},r.prototype.WriteCh5DeltaControl=function(){128!==(128&this.IO2[16])&&(this.toIRQ&=-129)},r.prototype.WriteCh5DeltaCounter=function(){this.WaveCh5DeltaCounter=127&this.IO2[17]},r.prototype.SetCh5Delta=function(){var t=this.IO2;this.WaveCh5DeltaCounter=127&t[17],this.WaveCh5SampleAddress=t[18]<<6,this.WaveCh5SampleCounter=(t[19]<<4)+1<<3,this.WaveCh5Register=0,this.WaveCh5Angle=-1,this.toIRQ&=-129},r.prototype.ApuInit=function(){this.WaveFrameSequence=0,this.WaveCh1LengthCounter=0,this.WaveCh1Envelope=0,this.WaveCh1EnvelopeCounter=0,this.WaveCh1Sweep=0,this.WaveCh1Frequency=0,this.WaveCh2LengthCounter=0,this.WaveCh2Envelope=0,this.WaveCh2EnvelopeCounter=0,this.WaveCh2Sweep=0,this.WaveCh2Frequency=0,this.WaveCh3LengthCounter=0,this.WaveCh3LinearCounter=0,this.WaveCh4LengthCounter=0,this.WaveCh4Envelope=0,this.WaveCh4EnvelopeCounter=0,this.WaveCh4Register=1,this.WaveCh4BitSequence=0,this.WaveCh5DeltaCounter=0,this.WaveCh5Register=0,this.WaveCh5SampleAddress=0,this.WaveCh5SampleCounter=0,this.WaveCh5Angle=-1,this.ApuClockCounter=0,this.WaveFrameSequenceCounter=0,this.WaveDatas=[],this.ApuCpuClockCounter=0,this.EXSoundInit()},r.prototype.Out_Apu=function(){var t=0,e=this.WaveBaseCount,s=e<<1,r=this.IO2;0!==this.WaveCh1LengthCounter&&this.WaveCh1Frequency>3&&(t+=(16===(16&r[0])?15&r[0]:this.WaveCh1EnvelopeCounter)*((s/this.WaveCh1Frequency&31)<this.WaveCh1_2DutyData[(192&r[0])>>6]?1:-1)),0!==this.WaveCh2LengthCounter&&this.WaveCh2Frequency>3&&(t+=(16===(16&r[4])?15&r[4]:this.WaveCh2EnvelopeCounter)*((s/this.WaveCh2Frequency&31)<this.WaveCh1_2DutyData[(192&r[4])>>6]?1:-1));var i=((7&r[11])<<8)+r[10]+1;0!==this.WaveCh3LengthCounter&&0!==this.WaveCh3LinearCounter&&i>3&&(t+=this.WaveCh3SequenceData[e/i&31]);var h=s/this.WaveCh4FrequencyData[15&r[14]]|0;if(h!==this.WaveCh4Angle&&(this.WaveCh4Register=128===(128&r[14])?this.WaveCh4Register>>1|(64&this.WaveCh4Register)<<8^(1&this.WaveCh4Register)<<14:this.WaveCh4Register>>1|(2&this.WaveCh4Register)<<13^(1&this.WaveCh4Register)<<14,this.WaveCh4Angle=h),0!==this.WaveCh4LengthCounter&&0===(1&this.WaveCh4Register)&&(t+=16===(16&r[12])?15&r[12]:this.WaveCh4EnvelopeCounter),0!==this.WaveCh5SampleCounter){if(h=e/this.WaveCh5FrequencyData[15&r[16]]&31,this.WaveCh5Angle!==h){var o=this.WaveCh5Angle,a=0;for(-1!==o&&(a=h,o>a&&(a+=32)),this.WaveCh5Angle=h;a>o;o++)0===(7&this.WaveCh5SampleCounter)&&0!==this.WaveCh5SampleCounter&&(this.WaveCh5Register=this.ROM[(this.WaveCh5SampleAddress>>13)+2][8191&this.WaveCh5SampleAddress],this.WaveCh5SampleAddress++,this.CPUClock+=4),0!==this.WaveCh5SampleCounter&&(0===(1&this.WaveCh5Register)?this.WaveCh5DeltaCounter>1&&(this.WaveCh5DeltaCounter-=2):this.WaveCh5DeltaCounter<126&&(this.WaveCh5DeltaCounter+=2),this.WaveCh5Register>>=1,this.WaveCh5SampleCounter--)}0===this.WaveCh5SampleCounter&&(64===(64&r[16])?this.SetCh5Delta():this.toIRQ|=128&r[16])}return t+this.WaveCh5DeltaCounter<<5},r.prototype.WaveFrameSequencer=function(t){this.WaveFrameSequenceCounter+=240*t,this.WaveFrameSequenceCounter>=this.MainClock&&(this.WaveFrameSequenceCounter-=this.MainClock,0===(128&this.IO2[23])?(this.WaveCh1_2_4_Envelope_WaveCh3_Linear(),1!==this.WaveFrameSequence&&3!==this.WaveFrameSequence||this.WaveCh1_2_3_4_Length_WaveCh1_2_Sweep(),3===this.WaveFrameSequence&&0===(64&this.IO2[23])&&(this.toIRQ|=64),this.WaveFrameSequence=3&++this.WaveFrameSequence):(4!==this.WaveFrameSequence&&this.WaveCh1_2_4_Envelope_WaveCh3_Linear(),0!==this.WaveFrameSequence&&2!==this.WaveFrameSequence||this.WaveCh1_2_3_4_Length_WaveCh1_2_Sweep(),this.WaveFrameSequence=++this.WaveFrameSequence%5))},r.prototype.ApuRun=function(){for(this.WaveBaseCount=(this.WaveBaseCount+this.CPUClock)%this.MainClock,this.WaveFrameSequencer(this.CPUClock),this.Mapper.EXSoundSync(this.CPUClock),this.ApuClockCounter+=this.WaveSampleRate*this.CPUClock;this.ApuClockCounter>=this.MainClock;)this.ApuClockCounter-=this.MainClock,this.Use_AudioContext&&this.WaveOut&&(this.WaveDatas.push(this.Mapper.OutEXSound(this.Out_Apu())),this.WebAudioGainNode.gain.value=this.WaveVolume)},r.prototype.WaveCh1_2_3_4_Length_WaveCh1_2_Sweep=function(){var t=this.IO2;0===(32&t[0])&&0!==this.WaveCh1LengthCounter&&0===--this.WaveCh1LengthCounter&&(t[21]&=254),0===(32&t[4])&&0!==this.WaveCh2LengthCounter&&0===--this.WaveCh2LengthCounter&&(t[21]&=253),0===(128&t[8])&&0!==this.WaveCh3LengthCounter&&0===--this.WaveCh3LengthCounter&&(t[21]&=251),0===(32&t[12])&&0!==this.WaveCh4LengthCounter&&0===--this.WaveCh4LengthCounter&&(t[21]&=247),++this.WaveCh1Sweep===((112&t[1])>>4)+1&&(this.WaveCh1Sweep=0,128===(128&t[1])&&0!==(7&t[1])&&0!==this.WaveCh1LengthCounter&&(0===(8&t[1])?this.WaveCh1Frequency+=this.WaveCh1Frequency>>(7&t[1]):this.WaveCh1Frequency-=this.WaveCh1Frequency>>(7&t[1]),(this.WaveCh1Frequency<8||this.WaveCh1Frequency>2047)&&(this.WaveCh1LengthCounter=0,t[21]&=254))),++this.WaveCh2Sweep===((112&t[5])>>4)+1&&(this.WaveCh2Sweep=0,128===(128&t[5])&&0!==(7&t[5])&&0!==this.WaveCh2LengthCounter&&(0===(8&t[5])?this.WaveCh2Frequency+=this.WaveCh2Frequency>>(7&t[5]):this.WaveCh2Frequency-=this.WaveCh2Frequency>>(7&t[5]),(this.WaveCh2Frequency<8||this.WaveCh2Frequency>2047)&&(this.WaveCh2LengthCounter=0,t[21]&=253)))},r.prototype.WaveCh1_2_4_Envelope_WaveCh3_Linear=function(){var t=this.IO2;0===(16&t[0])&&++this.WaveCh1Envelope===(15&t[0])+1&&(this.WaveCh1Envelope=0,0===this.WaveCh1EnvelopeCounter?32===(32&t[0])&&(this.WaveCh1EnvelopeCounter=15):this.WaveCh1EnvelopeCounter--),0===(16&t[4])&&++this.WaveCh2Envelope===(15&t[4])+1&&(this.WaveCh2Envelope=0,0===this.WaveCh2EnvelopeCounter?32===(32&t[4])&&(this.WaveCh2EnvelopeCounter=15):this.WaveCh2EnvelopeCounter--),0===(16&t[12])&&++this.WaveCh4Envelope===(15&t[12])+1&&(this.WaveCh4Envelope=0,0===this.WaveCh4EnvelopeCounter?32===(32&t[12])&&(this.WaveCh4EnvelopeCounter=15):this.WaveCh4EnvelopeCounter--),0===(128&t[8])&&0!==this.WaveCh3LinearCounter&&this.WaveCh3LinearCounter--},r.prototype.EXSoundInit=function(){this.Init_FDS(),this.Init_MMC5(),this.Init_VRC6(),this.Init_N163(),this.Init_AY()},r.prototype.Init_FDS=function(){var t;for(t=0;t<this.FDS_WAVE_REG.length;t++)this.FDS_WAVE_REG[t]=0;for(t=0;t<this.FDS_LFO_REG.length;t++)this.FDS_LFO_REG[t]=0;for(t=0;t<this.FDS_REG.length;t++)this.FDS_REG[t]=0;this.FDS_WaveIndexCounter=0,this.FDS_WaveIndex=0,this.FDS_LFOIndexCounter=0,this.FDS_LFOIndex=0,this.FDS_REGAddress=0,this.FDS_VolumeEnvCounter=0,this.FDS_VolumeEnv=0,this.FDS_SweepEnvCounter=0,this.FDS_SweepEnv=0,this.FDS_SweepBias=0,this.FDS_Volume=0},r.prototype.Write_FDS_WAVE_REG=function(t,e){128===(128&this.FDS_REG[9])&&(this.FDS_WAVE_REG[t]=63&e)},r.prototype.Write_FDS_REG=function(t,e){switch(this.FDS_REG[t]=e,t){case 0:128===(128&e)&&(this.FDS_VolumeEnv=63&e),this.FDS_VolumeEnvCounter=0;break;case 3:128===(128&e)&&(this.FDS_WaveIndex=0);break;case 4:128===(128&e)&&(this.FDS_SweepEnv=63&e),this.FDS_SweepEnvCounter=0;break;case 5:this.FDS_SweepBias=127&e,this.FDS_SweepBias>=64&&(this.FDS_SweepBias=this.FDS_SweepBias-128),this.FDS_REGAddress=0;break;case 7:this.FDS_LFOIndexCounter=0,this.FDS_LFOIndex=0;break;case 8:128===(128&this.FDS_REG[7])&&(this.FDS_LFO_REG[this.FDS_REGAddress]=7&e,this.FDS_REGAddress=this.FDS_REGAddress+1&31)}},r.prototype.Count_FDS=function(t){if(64!==(64&this.FDS_REG[3])){var e;if((192&this.FDS_REG[0])<128&&(e=this.FDS_REG[10]*((63&this.FDS_REG[0])+1)*8,e>0))for(this.FDS_VolumeEnvCounter+=t;this.FDS_VolumeEnvCounter>=e;)this.FDS_VolumeEnvCounter-=e,0===(64&this.FDS_REG[0])?this.FDS_VolumeEnv>0&&this.FDS_VolumeEnv--:this.FDS_VolumeEnv<32&&this.FDS_VolumeEnv++;if((192&this.FDS_REG[4])<128&&(e=this.FDS_REG[10]*((63&this.FDS_REG[4])+1)*8,e>0))for(this.FDS_SweepEnvCounter+=t;this.FDS_SweepEnvCounter>=e;)this.FDS_SweepEnvCounter-=e,0===(64&this.FDS_REG[4])?this.FDS_SweepEnv>0&&this.FDS_SweepEnv--:this.FDS_SweepEnv<63&&this.FDS_SweepEnv++}var s;if(128!==(128&this.FDS_REG[7]))for(s=this.FDS_REG[6]|(15&this.FDS_REG[7])<<8,this.FDS_LFOIndexCounter+=s*t;this.FDS_LFOIndexCounter>=65536;){this.FDS_LFOIndexCounter-=65536;var r=this.FDS_LFO_REG[this.FDS_LFOIndex>>1];this.FDS_SweepBias+=this.FDS_LFO_DATA[r],4===r&&(this.FDS_SweepBias=0),this.FDS_SweepBias>63?this.FDS_SweepBias-=128:this.FDS_SweepBias<-64&&(this.FDS_SweepBias+=128),this.FDS_LFOIndex+=1,this.FDS_LFOIndex>63&&(this.FDS_LFOIndex=0)}var i=this.FDS_SweepBias*this.FDS_SweepEnv,h=15&i;i>>=4,h>0&&(this.FDS_SweepBias<0?i-=1:i+=2),i>=192?i-=256:-64>i&&(i+=256),s=this.FDS_REG[2]|(15&this.FDS_REG[3])<<8,i=s*i,i>>=6,s+=i,this.FDS_WaveIndexCounter+=s*t,this.FDS_WaveIndex+=this.FDS_WaveIndexCounter>>16,this.FDS_WaveIndexCounter&=65535,this.FDS_WaveIndex>63&&(this.FDS_WaveIndex&=63,this.FDS_Volume=this.FDS_VolumeEnv)},r.prototype.Out_FDS=function(){return 128!==(128&this.FDS_REG[3])?(this.FDS_WAVE_REG[this.FDS_WaveIndex]-32)*this.FDS_Volume>>1:0},r.prototype.Init_MMC5=function(){this.MMC5_FrameSequenceCounter=0,this.MMC5_FrameSequence=0;for(var t=0;t<this.MMC5_REG.length;t++)this.MMC5_REG[t]=0;this.MMC5_Ch[0]={LengthCounter:0,Envelope:0,EnvelopeCounter:0,Sweep:0,Frequency:0},this.MMC5_Ch[1]={LengthCounter:0,Envelope:0,EnvelopeCounter:0,Sweep:0,Frequency:0}},r.prototype.Write_MMC5_ChLength0=function(t){var e=t<<2;this.MMC5_Ch[t].Frequency=((7&this.MMC5_REG[e+3])<<8)+this.MMC5_REG[e+2]+1},r.prototype.Write_MMC5_ChLength1=function(t){var e=t<<2;this.MMC5_Ch[t].LengthCounter=this.WaveLengthCount[this.MMC5_REG[e+3]>>3],this.MMC5_Ch[t].Envelope=0,this.MMC5_Ch[t].EnvelopeCounter=15,this.MMC5_Ch[t].Sweep=0,this.MMC5_Ch[t].Frequency=((7&this.MMC5_REG[e+3])<<8)+this.MMC5_REG[e+2]+1},r.prototype.Write_MMC5_REG=function(t,e){switch(this.MMC5_REG[t]=e,t){case 2:this.Write_MMC5_ChLength0(0);break;case 3:this.Write_MMC5_ChLength1(0);break;case 6:this.Write_MMC5_ChLength0(1);break;case 7:this.Write_MMC5_ChLength1(1);break;case 21:for(var s=0;2>s;s++)0===(this.MMC5_REG[21]&1<<s)&&(this.MMC5_Ch[s].LengthCounter=0)}},r.prototype.Read_MMC5_REG=function(t){if(21===t)for(var e=0,s=0;2>s;s++)0!==this.MMC5_Ch[s].LengthCounter&&(e|=1<<s)},r.prototype.Count_MMC5=function(t){this.MMC5_FrameSequenceCounter+=240*t;var e,s;if(this.MMC5_FrameSequenceCounter>=this.MainClock){for(this.MMC5_FrameSequenceCounter-=this.MainClock,e=0;2>e;e++)s=e<<2,0===(16&this.MMC5_REG[s])&&++this.MMC5_Ch[e].Envelope===(15&this.MMC5_REG[s])+1&&(this.MMC5_Ch[e].Envelope=0,0===this.MMC5_Ch[e].EnvelopeCounter?32===(32&this.MMC5_REG[s])&&(this.MMC5_Ch[e].EnvelopeCounter=15):this.MMC5_Ch[e].EnvelopeCounter--);if(1===this.MMC5_FrameSequence||3===this.MMC5_FrameSequence)for(e=0;2>e;e++)s=e<<2,0===(32&this.MMC5_REG[s])&&0!==this.MMC5_Ch[e].LengthCounter&&0===--this.MMC5_Ch[e].LengthCounter&&(this.MMC5_REG[21]&=~(1<<e)),++this.MMC5_Ch[e].Sweep===((112&this.MMC5_REG[s+1])>>4)+1&&(this.MMC5_Ch[e].Sweep=0,128===(128&this.MMC5_REG[s+1])&&0!==(7&this.MMC5_REG[s+1])&&0!==this.MMC5_Ch[e].LengthCounter&&(0===(8&this.MMC5_REG[s+1])?this.MMC5_Ch[e].Frequency+=this.MMC5_Ch[e].Frequency>>(7&this.MMC5_REG[s+1]):this.MMC5_Ch[e].Frequency-=this.MMC5_Ch[e].Frequency>>(7&this.MMC5_REG[s+1]),(this.MMC5_Ch[e].Frequency<8||this.MMC5_Ch[e].Frequency>2047)&&(this.MMC5_Ch[e].LengthCounter=0,this.MMC5_REG[21]&=~(1<<e))));this.MMC5_FrameSequence=3&++this.MMC5_FrameSequence}},r.prototype.Out_MMC5=function(){for(var t=0,e=this.WaveBaseCount<<1,s=0;2>s;s++){var r=s<<2;0!==this.MMC5_Ch[s].LengthCounter&&this.MMC5_Ch[s].Frequency>3&&(t+=(16===(16&this.MMC5_REG[r])?15&this.MMC5_REG[r]:this.MMC5_Ch[s].EnvelopeCounter)*((e/this.MMC5_Ch[s].Frequency&31)<this.WaveCh1_2DutyData[(192&this.MMC5_REG[r])>>6]?1:-1))}return t+=(this.MMC5_REG[17]>>2)-16,t<<5},r.prototype.Init_VRC6=function(){for(var t=0;t<this.VRC6_REG.length;t++)this.VRC6_REG[t]=0;this.VRC6_Ch3_Counter=0,this.VRC6_Ch3_index=0},r.prototype.Write_VRC6_REG=function(t,e){this.VRC6_REG[t]=e},r.prototype.Count_VRC6=function(t){var e=((15&this.VRC6_REG[10])<<8|this.VRC6_REG[9])+1;this.VRC6_Ch3_Counter+=t,this.VRC6_Ch3_index+=this.VRC6_Ch3_Counter/e|0,this.VRC6_Ch3_index%=14,this.VRC6_Ch3_Counter%=e},r.prototype.Out_VRC6=function(){for(var t=0,e=this.WaveBaseCount,s=0;8>s;s+=4)if(128===(128&this.VRC6_REG[s+2]))if(0===(128&this.VRC6_REG[s+0])){var r=(15&this.VRC6_REG[s+2])<<8|this.VRC6_REG[s+1],i=(112&this.VRC6_REG[s+0])>>>4;t+=(15&this.VRC6_REG[s+0])*(i>(e/r&15)?1:-1)}else t+=15&this.VRC6_REG[s+0];return 128===(128&this.VRC6_REG[10])&&(t+=((this.VRC6_Ch3_index>>>1)*(63&this.VRC6_REG[8])>>>3)-16),t<<5},r.prototype.Init_N163=function(){var t;for(t=0;t<this.N163_RAM.length;t++)this.N163_RAM[t]=0;for(t=0;t<this.N163_ch_data.length;t++)this.N163_ch_data[t]={Freq:0,Phase:0,Length:0,Address:0,Vol:0};this.N163_Address=0,this.N163_ch=0,this.N163_Clock=0},r.prototype.Write_N163_RAM=function(t){var e=127&this.N163_Address;if(this.N163_RAM[e]=t,e>=64){var s=e>>>3&7;switch(7&e){case 0:this.N163_ch_data[s].Freq=261888&this.N163_ch_data[s].Freq|t;break;case 1:this.N163_ch_data[s].Phase=16776960&this.N163_ch_data[s].Freq|t;break;case 2:this.N163_ch_data[s].Freq=196863&this.N163_ch_data[s].Freq|t<<8;break;case 3:this.N163_ch_data[s].Phase=16711935&this.N163_ch_data[s].Freq|t<<8;break;case 4:this.N163_ch_data[s].Freq=65535&this.N163_ch_data[s].Freq|(3&t)<<16,this.N163_ch_data[s].Length=256-(252&t)<<16;break;case 5:this.N163_ch_data[s].Phase=65535&this.N163_ch_data[s].Freq|t<<16;break;case 6:this.N163_ch_data[s].Address=t;break;case 7:this.N163_ch_data[s].Vol=15&t,127===e&&(this.N163_ch=t>>>4&7)}}128===(128&this.N163_Address)&&(this.N163_Address=(127&this.N163_Address)+1|128)},r.prototype.Read_N163_RAM=function(){var t=this.N163_RAM[127&this.N163_Address];return 128===(128&this.N163_Address)&&(this.N163_Address=(127&this.N163_Address)+1|128),t},r.prototype.Count_N163=function(t){this.N163_Clock+=t;for(var e=15*(this.N163_ch+1);this.N163_Clock>=e;){this.N163_Clock-=e;for(var s=7-this.N163_ch;8>s;s++)this.N163_ch_data[s].Length>0&&(this.N163_ch_data[s].Phase=(this.N163_ch_data[s].Phase+this.N163_ch_data[s].Freq)%this.N163_ch_data[s].Length)}},r.prototype.Out_N163=function(){for(var t=0,e=7-this.N163_ch;8>e;e++){var s=this.N163_ch_data[e].Address+(this.N163_ch_data[e].Phase>>16)&255,r=this.N163_RAM[s>>>1];r=0===(1&s)?15&r:r>>>4,t+=(r-8)*this.N163_ch_data[e].Vol}return t<<2},r.prototype.Init_AY=function(){this.AY_ClockCounter=0;for(var t=0;t<this.AY_REG.length;t++)this.AY_REG[t]=0;this.AY_Noise_Seed=1,this.AY_Noise_Angle=0,this.AY_Env_Counter=0,this.AY_Env_Index=0,this.AY_REG_Select=0},r.prototype.Select_AY_REG=function(t){this.AY_REG_Select=15&t},r.prototype.Write_AY_REG=function(t){this.AY_REG[this.AY_REG_Select]=t,13===this.AY_REG_Select&&(this.AY_Env_Index=0)},r.prototype.Read_AY_REG=function(){return 0},r.prototype.Count_AY=function(t){this.AY_Env_Counter+=t;var e=8*((this.AY_REG[12]<<8|this.AY_REG[11])+1),s=this.AY_Env_Counter/e|0;this.AY_Env_Counter%=e,this.AY_Env_Index+=s,this.AY_Env_Index>=48&&(this.AY_Env_Index=(this.AY_Env_Index-48)%32+32)},r.prototype.Out_AY=function(){var t=this.WaveBaseCount,e=0,s=1===(1&this.AY_Noise_Seed)?1:-1,r=t/(32*((31&this.AY_REG[5])+1))|0;r!==this.AY_Noise_Angle&&(this.AY_Noise_Seed=this.AY_Noise_Seed>>>1|(1&this.AY_Noise_Seed)<<15^(8&this.AY_Noise_Seed)<<12,this.AY_Noise_Angle=r);for(var i=0;3>i;i++){var h=0===(16&this.AY_REG[8+i])?15&this.AY_REG[8+i]:this.AY_Env_Pattern[15&this.AY_REG[13]][this.AY_Env_Index];if(h=this.AY_Env_Volume[h],0===(this.AY_REG[7]>>i&1)){var o=((15&this.AY_REG[2*i+1])<<8|this.AY_REG[2*i])+1;e+=o>1?h*(16>(t/o&31)?1:-1):h}0===(this.AY_REG[7]>>i&8)&&(e+=h*s)}return e},e.exports=r},{}],3:[function(t,e,s){"use strict";function r(){p.Pause()&&(document.getElementById("pause").disabled=!0,document.getElementById("start").disabled=!1)}function i(){p.Start()&&(document.getElementById("pause").disabled=!1,document.getElementById("start").disabled=!0)}function h(){p.Reset()&&(document.getElementById("pause").disabled=!1,document.getElementById("start").disabled=!0)}function o(t){return r(),p.SetRom(t)?(document.getElementById("start").disabled=!0,document.getElementById("pause").disabled=!0,void(p.Init()&&i())):void console.error("Can't get rom data (perhaps you don't set ArrayBuffer arguments or it's not nes rom format)")}function a(){var t=p.Mapper.OutSRAM();document.getElementById("sramdata").value=t}function P(){p.Mapper.InSRAM(document.getElementById("sramdata").value)}var R=t("./MapperNES"),p=new R;p.SetCanvas("mainCanvas");var E=function(t,e){var s=new FileReader;s.onload=function(t){e(t.target.result)},s.readAsArrayBuffer(t)},C=function(t,e){var s=new XMLHttpRequest;s.responseType="arraybuffer",s.onload=function(){e(s.response)},s.onerror=function(t){console.error("can't get rom binary")},s.open("GET",t,!0),s.send(null)},M=function(){"undefined"!=typeof window.FileReader&&(window.addEventListener("dragenter",function(t){t.preventDefault()},!1),window.addEventListener("dragover",function(t){t.preventDefault()},!1),window.addEventListener("drop",function(t){t.preventDefault(),E(t.dataTransfer.files[0],o)},!1),document.getElementById("file").addEventListener("change",function(t){E(t.target.files[0],o)},!1),document.getElementById("pause").addEventListener("click",r,!1),document.getElementById("start").addEventListener("click",i,!1),document.getElementById("reset").addEventListener("click",h,!1),document.getElementById("sramout").addEventListener("click",a,!1),document.getElementById("sramin").addEventListener("click",P,!1),document.getElementById("start").disabled=!0,document.getElementById("pause").disabled=!0)};window.onload=function(){M();var t="rom/bad_apple_2_5.nes";C(t,o)}},{"./MapperNES":1}]},{},[3]);